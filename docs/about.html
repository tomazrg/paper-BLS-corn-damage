<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>about – Modeling BLS damage</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>



<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Modeling BLS damage</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><i class="bi bi-book-half"></i> About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./about.html" aria-current="page"> 
<span class="menu-text"><i class="bi bi-bar-chart-fill"></i> Data Analysis</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/tomazrg/paper-BLS-corn-damage"> 
<span class="menu-text"><i class="bi bi-github"></i> GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/ricardo-gomes-tom%C3%A1z-0137ba189/"> 
<span class="menu-text"><i class="bi bi-linkedin"></i> Linkedin</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#importation" id="toc-importation" class="nav-link" data-scroll-target="#importation">Importation</a></li>
  <li><a href="#descriptive-analysis" id="toc-descriptive-analysis" class="nav-link" data-scroll-target="#descriptive-analysis">Descriptive analysis</a>
  <ul class="collapse">
  <li><a href="#severity" id="toc-severity" class="nav-link" data-scroll-target="#severity">Severity</a></li>
  <li><a href="#yield" id="toc-yield" class="nav-link" data-scroll-target="#yield">Yield</a></li>
  <li><a href="#prepare-data" id="toc-prepare-data" class="nav-link" data-scroll-target="#prepare-data">Prepare data</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#fitting" id="toc-fitting" class="nav-link" data-scroll-target="#fitting">Fitting</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  <li><a href="#joining" id="toc-joining" class="nav-link" data-scroll-target="#joining">Joining</a></li>
  </ul></li>
  <li><a href="#performance" id="toc-performance" class="nav-link" data-scroll-target="#performance">Performance</a>
  <ul class="collapse">
  <li><a href="#empirical" id="toc-empirical" class="nav-link" data-scroll-target="#empirical">Empirical</a></li>
  <li><a href="#simulated" id="toc-simulated" class="nav-link" data-scroll-target="#simulated">Simulated</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  <li><a href="#power-analysis-of-model-by-simulation" id="toc-power-analysis-of-model-by-simulation" class="nav-link" data-scroll-target="#power-analysis-of-model-by-simulation">Power analysis of model by simulation</a>
  <ul class="collapse">
  <li><a href="#severity-1" id="toc-severity-1" class="nav-link" data-scroll-target="#severity-1">Severity</a></li>
  </ul></li>
  <li><a href="#damage" id="toc-damage" class="nav-link" data-scroll-target="#damage">Damage</a>
  <ul class="collapse">
  <li><a href="#economic-losses" id="toc-economic-losses" class="nav-link" data-scroll-target="#economic-losses">Economic losses</a></li>
  <li><a href="#relative-yield" id="toc-relative-yield" class="nav-link" data-scroll-target="#relative-yield">Relative yield</a></li>
  </ul></li>
  <li><a href="#break-even-probability" id="toc-break-even-probability" class="nav-link" data-scroll-target="#break-even-probability">Break-even probability</a>
  <ul class="collapse">
  <li><a href="#framework-simulation" id="toc-framework-simulation" class="nav-link" data-scroll-target="#framework-simulation">Framework simulation</a>
  <ul class="collapse">
  <li><a href="#norta-function" id="toc-norta-function" class="nav-link" data-scroll-target="#norta-function">NORTA function</a></li>
  <li><a href="#severity-2" id="toc-severity-2" class="nav-link" data-scroll-target="#severity-2">Severity</a></li>
  <li><a href="#intercept" id="toc-intercept" class="nav-link" data-scroll-target="#intercept">Intercept</a></li>
  <li><a href="#slope" id="toc-slope" class="nav-link" data-scroll-target="#slope">Slope</a></li>
  <li><a href="#corn-price" id="toc-corn-price" class="nav-link" data-scroll-target="#corn-price">Corn price</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="packages" class="level1">
<h1>Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gsheet)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importation" class="level1">
<h1>Importation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gls <span class="ot">=</span> <span class="fu">gsheet2tbl</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1TC_-I7OpUloaqh5sd3mVu8YW-V1Lxk8SZ_DRCIUmWOE/edit?usp=sharing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descriptive-analysis" class="level1">
<h1>Descriptive analysis</h1>
<section id="severity" class="level2">
<h2 class="anchored" data-anchor-id="severity">Severity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plot_sev <span class="ot">=</span> gls <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sev))<span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#stat_function(fun=function(x) dbeta(x, 0.94145, 6.45601), color= "darkred", size = 1.2)+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="yield" class="level2">
<h2 class="anchored" data-anchor-id="yield">Yield</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>yy <span class="ot">=</span> gls <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>yld <span class="sc">&lt;=</span> <span class="dv">1500</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gls<span class="sc">$</span>yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8965.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(gls<span class="sc">$</span>yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13073.42</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(yy<span class="sc">$</span>yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3382.11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(yy<span class="sc">$</span>yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       0%       25%       50%       75%      100% 
 3382.110  8018.915  8971.835  9844.248 13073.420 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mean_intercept <span class="ot">=</span> <span class="fu">mean</span>(gls<span class="sc">$</span>yld)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sd_intercept <span class="ot">=</span> <span class="fu">sd</span>(gls<span class="sc">$</span>yld)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plot_yld <span class="ot">=</span> gls <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>yld <span class="sc">&lt;=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(yld))<span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># Ajusta para densidade</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>, <span class="dv">14000</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">14000</span>))<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>plot_yld</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(plot_sev, plot_yld, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">0.03</span>, <span class="at">label_size =</span> <span class="dv">14</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"(a)"</span>,<span class="st">"(b)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/sev_yld.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data">Prepare data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>estria2 <span class="ot">&lt;-</span> gls <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trial, hybrid) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_sev =</span> <span class="fu">mean</span>(sev),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_yld =</span> <span class="fu">mean</span>(yld))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(estria2<span class="sc">$</span>mean_sev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.66667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(estria2<span class="sc">$</span>mean_sev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(estria2<span class="sc">$</span>mean_sev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.83716</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(estria2<span class="sc">$</span>mean_sev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(estria2<span class="sc">$</span>mean_sev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.12138</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12503.86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3909.777</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8964.191</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8989.737</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1359.003</code></pre>
</div>
</div>
</section>
<section id="visualize" class="level2">
<h2 class="anchored" data-anchor-id="visualize">Visualize</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>estria2 <span class="ot">=</span> estria2 <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">period =</span> <span class="fu">case_when</span>(trial <span class="sc">==</span> <span class="st">"2018_1"</span><span class="sc">~</span> <span class="st">"2018/1"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                       trial <span class="sc">==</span> <span class="st">"2018_2"</span> <span class="sc">~</span><span class="st">"2018/2"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                       trial <span class="sc">==</span> <span class="st">"2018_19"</span><span class="sc">~</span><span class="st">"2018/2019"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                       trial <span class="sc">==</span> <span class="st">"2019_1"</span> <span class="sc">~</span><span class="st">"2019/1"</span>))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a> trials <span class="ot">=</span> estria2 <span class="sc">|&gt;</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, mean_yld, <span class="at">group =</span> <span class="fu">as.factor</span>(period),<span class="at">color =</span> <span class="fu">as.factor</span>(period)))<span class="sc">+</span> <span class="co">#</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~period)+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>,<span class="dv">6000</span>,<span class="dv">7000</span>,<span class="dv">8000</span>,<span class="dv">9000</span>,<span class="dv">10000</span>,<span class="dv">11000</span>,<span class="dv">12000</span>), </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Seasons"</span>)<span class="sc">+</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_abline(slope = -49.3, intercept = 9714, linetype = 1, linewidth =2, color = "gray50")</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/trials.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>lmer_stats <span class="ot">=</span> estria2 <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#group_by(year) %&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(trial, mean_yld,mean_sev) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trial) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>({</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(.<span class="sc">$</span>mean_yld <span class="sc">~</span> .<span class="sc">$</span>mean_sev)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    tidy_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    confint_model <span class="ot">&lt;-</span> <span class="fu">confint</span>(model)  <span class="co"># Calcula os intervalos de confiança</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(tidy_model, confint_model)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>lmer_stats <span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,<span class="st">".$mean_sev"</span>))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>lmer_stats[lmer_stats<span class="sc">$</span>term<span class="sc">==</span> <span class="st">"(Intercept)"</span>,<span class="fu">c</span>(<span class="st">"parameters"</span>)] <span class="ot">&lt;-</span> <span class="st">"Intercept"</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>lmer_stats[lmer_stats<span class="sc">$</span>term<span class="sc">==</span> <span class="st">".$mean_sev"</span>,<span class="fu">c</span>(<span class="st">"parameters"</span>)] <span class="ot">&lt;-</span> <span class="st">"Slope"</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="fu">nrow</span>(lmer_stats)) {</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lmer_stats<span class="sc">$</span>parameters[i] <span class="sc">==</span> <span class="st">"Slope"</span> <span class="sc">&amp;&amp;</span> lmer_stats<span class="sc">$</span>estimate[i] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove a linha do Slope e a linha do Intercept correspondente</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    lmer_stats <span class="ot">&lt;-</span> lmer_stats[<span class="sc">-</span><span class="fu">c</span>(i, i <span class="sc">-</span> <span class="dv">1</span>), ]</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Atualiza o índice, pois duas linhas foram removidas</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>lmer_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["trial"],"name":[1],"type":["chr"],"align":["left"]},{"label":["term"],"name":[2],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["2.5 %"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["97.5 %"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["parameters"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"2018_1","2":"(Intercept)","3":"8457.68609","4":"172.323192","5":"49.080370","6":"1.105942e-42","7":"8111.20709","8":"8804.165093","9":"Intercept"},{"1":"2018_1","2":".$mean_sev","3":"-42.80137","4":"8.569017","5":"-4.994899","6":"8.202942e-06","7":"-60.03054","8":"-25.572209","9":"Slope"},{"1":"2018_19","2":"(Intercept)","3":"11240.04732","4":"335.379983","5":"33.514365","6":"4.577991e-27","7":"10557.71161","8":"11922.383027","9":"Intercept"},{"1":"2018_19","2":".$mean_sev","3":"-77.41088","4":"14.529646","5":"-5.327788","6":"7.012154e-06","7":"-106.97166","8":"-47.850090","9":"Slope"},{"1":"2018_2","2":"(Intercept)","3":"9468.44307","4":"144.517611","5":"65.517572","6":"6.051924e-34","7":"9173.29874","8":"9763.587412","9":"Intercept"},{"1":"2018_2","2":".$mean_sev","3":"-34.04084","4":"10.035414","5":"-3.392072","6":"1.964128e-03","7":"-54.53589","8":"-13.545793","9":"Slope"},{"1":"2019_1","2":"(Intercept)","3":"9680.49201","4":"223.511723","5":"43.310892","6":"3.450081e-44","7":"9232.56450","8":"10128.419510","9":"Intercept"},{"1":"2019_1","2":".$mean_sev","3":"-31.02541","4":"12.721319","5":"-2.438852","6":"1.798961e-02","7":"-56.51950","8":"-5.531318","9":"Slope"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>slope_trial_m<span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Slope"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Slope =</span> estimate</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>slope_trial_m[,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>slope_trial_m <span class="sc">|&gt;</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Slope <span class="sc">==</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="at">mean =</span> <span class="fu">mean</span>(Slope))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"-46.31963"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>intercept_trial_m <span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intercept =</span> estimate</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>intercept_trial_m[,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(intercept_trial_m<span class="sc">$</span>Intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9711.667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>regression_trial_m <span class="ot">=</span> <span class="fu">cbind</span>(slope_trial_m,intercept_trial_m)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>regression_trial_m[,<span class="dv">3</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> regression_trial_m <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_intercept =</span> <span class="fu">mean</span>(Intercept),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_slope =</span> <span class="fu">mean</span>(Slope),</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_intercept_lower =</span> <span class="fu">quantile</span>(Intercept, <span class="fl">0.025</span>),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_intercept_upper =</span> <span class="fu">quantile</span>(Intercept, <span class="fl">0.975</span>),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_slope_lower =</span> <span class="fu">quantile</span>(Slope, <span class="fl">0.025</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_slope_upper =</span> <span class="fu">quantile</span>(Slope, <span class="fl">0.975</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>trials <span class="ot">=</span> estria2<span class="sc">|&gt;</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, <span class="at">y =</span> mean_yld)) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"NA"</span>)<span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span>regression_trial_m, <span class="fu">aes</span>(<span class="at">slope =</span> Slope, <span class="at">intercept =</span> Intercept), <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span><span class="do">##9ccb86</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_abline(data =summary_stats, aes(slope = mean_slope, intercept = mean_intercept),</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>   <span class="co">#           size = 1.5, fill = "black", color = "black")+</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_abline</span>(<span class="at">data =</span> summary_stats,<span class="fu">aes</span>(<span class="at">intercept =</span> ci_intercept_lower,<span class="at">slope =</span> ci_slope_lower) ,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> summary_stats, <span class="fu">aes</span>(<span class="at">intercept =</span> ci_intercept_upper,<span class="at">slope =</span> ci_slope_upper), <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="sc">-</span><span class="fl">49.37</span>, <span class="at">intercept =</span> <span class="fl">9714.0</span>),</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fl">8699.1</span>,<span class="at">slope =</span> <span class="sc">-</span><span class="fl">60.59</span>) ,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">51</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fl">10733.8</span>,<span class="at">slope =</span> <span class="sc">-</span><span class="fl">38.00</span>), <span class="at">size =</span> .<span class="dv">51</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>, <span class="at">y =</span> <span class="st">"Attainable yield (kg/ha)"</span>,</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>first_plot <span class="ot">=</span> estria2 <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="st">"2018_1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, mean_yld))<span class="sc">+</span> <span class="co">#, group = trial, color = trial</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>trial)<span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">7500</span>, <span class="dv">10000</span>,<span class="dv">12500</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">12500</span>))<span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Severity (%)"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Trial"</span>)<span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>second_plot <span class="ot">=</span> estria2 <span class="sc">|&gt;</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="st">"2018_2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, mean_yld))<span class="sc">+</span> <span class="co">#, group = trial, color = trial</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>trial)<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">7500</span>, <span class="dv">10000</span>,<span class="dv">12500</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">12500</span>))<span class="sc">+</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Severity (%)"</span>,</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Trial"</span>)<span class="sc">+</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>third_plot <span class="ot">=</span> estria2 <span class="sc">|&gt;</span> </span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="st">"2018_19"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, mean_yld))<span class="sc">+</span> <span class="co">#, group = trial, color = trial</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>trial)<span class="sc">+</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">7500</span>, <span class="dv">10000</span>,<span class="dv">12500</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">12500</span>))<span class="sc">+</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Severity (%)"</span>,</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Trial"</span>)<span class="sc">+</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>fourth_plot <span class="ot">=</span> estria2 <span class="sc">|&gt;</span> </span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trial <span class="sc">==</span> <span class="st">"2019_1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev, mean_yld))<span class="sc">+</span> <span class="co">#, group = trial, color = trial</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>trial)<span class="sc">+</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">7500</span>, <span class="dv">10000</span>,<span class="dv">12500</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">12500</span>))<span class="sc">+</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Severity (%)"</span>,</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (kg/ha)"</span>,</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Trial"</span>)<span class="sc">+</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (first_plot <span class="sc">|</span> plot_yld <span class="sc">|</span> second_plot) <span class="sc">/</span> </span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>                 (third_plot <span class="sc">|</span> plot_sev <span class="sc">|</span> fourth_plot) <span class="sc">+</span></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/plot_all.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="modeling" class="level1">
<h1>Modeling</h1>
<section id="fitting" class="level3">
<h3 class="anchored" data-anchor-id="fitting">Fitting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a mixed-effects model</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>obs_model_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(mean_yld <span class="sc">~</span> mean_sev <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> trial), <span class="at">data =</span> estria2)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(obs_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: mean_yld ~ mean_sev + (1 | trial)
   Data: estria2

REML criterion at convergence: 2880.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4362 -0.7056  0.0671  0.7105  2.0247 

Random effects:
 Groups   Name        Variance Std.Dev.
 trial    (Intercept) 820678   905.9   
 Residual             941736   970.4   
Number of obs: 174, groups:  trial, 4

Fixed effects:
            Estimate Std. Error t value
(Intercept) 9714.049    465.870  20.851
mean_sev     -49.378      5.745  -8.595

Correlation of Fixed Effects:
         (Intr)
mean_sev -0.168</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(obs_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %      97.5 %
.sig01       426.84166  1944.19893
.sigma       873.17446  1080.29427
(Intercept) 8699.18638 10733.83869
mean_sev     -60.59337   -38.00271</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters from the fitted model</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fixed_intercept <span class="ot">&lt;-</span> <span class="fl">9714.049</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>fixed_slope <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">49.378</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>random_effect_sd <span class="ot">&lt;-</span> <span class="fl">905.9</span>  <span class="co"># sqrt(820678)</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>residual_sd <span class="ot">&lt;-</span> <span class="fl">970.4</span>       <span class="co"># sqrt(941736)</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of experiments and points per experiment</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>num_experiments <span class="ot">&lt;-</span> <span class="dv">200</span>  <span class="co"># New experiments</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>points_per_experiment <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the range of observed severity values from the original dataset</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate data with variable max severity for each experiment</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>simulated_data_lmer <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (exp <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_experiments) {</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate random intercept for the experiment</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  u_j <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> random_effect_sd)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Randomly select a max severity for this simulation between 50% and 80%</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  max_sev_sim <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">20</span>, <span class="at">max =</span> <span class="dv">80</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate severity values (independent variable) within the 0 to max_sev_sim range</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  sev <span class="ot">&lt;-</span> <span class="fu">runif</span>(points_per_experiment, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> max_sev_sim)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate residuals</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  residuals <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(points_per_experiment, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> residual_sd)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate yield (dependent variable)</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  yld <span class="ot">&lt;-</span> fixed_intercept <span class="sc">+</span> u_j <span class="sc">+</span> fixed_slope <span class="sc">*</span> sev <span class="sc">+</span> residuals</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine into a data frame</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  exp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">experiment =</span> <span class="fu">paste0</span>(<span class="st">"Exp_"</span>, exp), <span class="at">sev =</span> sev, <span class="at">yld =</span> yld)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  simulated_data_lmer <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulated_data_lmer, exp_data)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>simulated_data_lmer<span class="sc">$</span>hybrid <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"hybrid_"</span>, <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, (<span class="fu">seq_len</span>(<span class="fu">nrow</span>(simulated_data_lmer)) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co"># View simulated data</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simulated_data_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["experiment"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["yld"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hybrid"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Exp_1","2":"39.328372","3":"6133.313","4":"hybrid_01","_rn_":"1"},{"1":"Exp_1","2":"41.887111","3":"6343.725","4":"hybrid_01","_rn_":"2"},{"1":"Exp_1","2":"2.029023","3":"9770.787","4":"hybrid_01","_rn_":"3"},{"1":"Exp_1","2":"23.521087","3":"7734.307","4":"hybrid_01","_rn_":"4"},{"1":"Exp_1","2":"39.747109","3":"5970.980","4":"hybrid_01","_rn_":"5"},{"1":"Exp_1","2":"24.560152","3":"7411.723","4":"hybrid_01","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simulated_data_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  experiment             sev                yld           hybrid         
 Length:10000       Min.   : 0.00051   Min.   : 2528   Length:10000      
 Class :character   1st Qu.:10.61846   1st Qu.: 7391   Class :character  
 Mode  :character   Median :21.04083   Median : 8509   Mode  :character  
                    Mean   :24.67849   Mean   : 8472                     
                    3rd Qu.:36.17231   3rd Qu.: 9594                     
                    Max.   :78.27768   Max.   :14239                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare simulated and real severity-yield relationships</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simulated_data_lmer, <span class="fu">aes</span>(<span class="at">x =</span> sev, <span class="at">y =</span> yld, <span class="at">color =</span> experiment)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulated Severity-Yield Data"</span>, <span class="at">x =</span> <span class="st">"Severity"</span>, <span class="at">y =</span> <span class="st">"Yield"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>simu_model_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(yld <span class="sc">~</span> sev <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> experiment), <span class="at">data =</span> simulated_data_lmer)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>simu_model_lmer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: yld ~ sev + (1 | experiment)
   Data: simulated_data_lmer
REML criterion at convergence: 166620.8
Random effects:
 Groups     Name        Std.Dev.
 experiment (Intercept) 937.3   
 Residual               966.9   
Number of obs: 10000, groups:  experiment, 200
Fixed Effects:
(Intercept)          sev  
    9691.01       -49.39  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simu_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: yld ~ sev + (1 | experiment)
   Data: simulated_data_lmer

REML criterion at convergence: 166620.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.6504 -0.6689  0.0041  0.6771  3.3524 

Random effects:
 Groups     Name        Variance Std.Dev.
 experiment (Intercept) 878546   937.3   
 Residual               934819   966.9   
Number of obs: 10000, groups:  experiment, 200

Fixed effects:
             Estimate Std. Error t value
(Intercept) 9691.0145    68.8438  140.77
sev          -49.3879     0.6449  -76.59

Correlation of Fixed Effects:
    (Intr)
sev -0.231</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(simu_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
.sig01       848.3483 1036.5979
.sigma       953.4327  980.5062
(Intercept) 9555.8113 9826.1935
sev          -50.6520  -48.1241</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>obs_fixed_effects_lmer <span class="ot">&lt;-</span> <span class="fu">fixef</span>(obs_model_lmer)  <span class="co"># From the original model</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>simu_fixed_effects_lmer <span class="ot">&lt;-</span> <span class="fu">fixef</span>(simu_model_lmer)  <span class="co"># From the simulated model</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obs_fixed_effects_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    mean_sev 
 9714.04857   -49.37773 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(simu_fixed_effects_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         sev 
 9691.01451   -49.38785 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>obs_random_effects_lmer <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(obs_model_lmer)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>simu_random_effects_lmer <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(simu_model_lmer)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obs_random_effects_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups   Name        Std.Dev.
 trial    (Intercept) 905.91  
 Residual             970.43  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(simu_random_effects_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups     Name        Std.Dev.
 experiment (Intercept) 937.31  
 Residual               966.86  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>obs_residual_sd_lmer <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">VarCorr</span>(obs_model_lmer), <span class="st">"sc"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>simu_residual_sd_lmer <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">VarCorr</span>(simu_model_lmer), <span class="st">"sc"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(obs_residual_sd_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 970.4308</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(simu_residual_sd_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 966.8604</code></pre>
</div>
</div>
</section>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">Plotting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>lmer_stats <span class="ot">=</span> simulated_data_lmer <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#group_by(year) %&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(experiment, yld,sev) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(experiment) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>({</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(.<span class="sc">$</span>yld <span class="sc">~</span> .<span class="sc">$</span>sev)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    tidy_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    confint_model <span class="ot">&lt;-</span> <span class="fu">confint</span>(model)  <span class="co"># Calcula os intervalos de confiança</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(tidy_model, confint_model)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>lmer_stats <span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,<span class="st">".$sev"</span>))</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>lmer_stats[lmer_stats<span class="sc">$</span>term<span class="sc">==</span> <span class="st">"(Intercept)"</span>,<span class="fu">c</span>(<span class="st">"parameters"</span>)] <span class="ot">&lt;-</span> <span class="st">"Intercept"</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>lmer_stats[lmer_stats<span class="sc">$</span>term<span class="sc">==</span> <span class="st">".$sev"</span>,<span class="fu">c</span>(<span class="st">"parameters"</span>)] <span class="ot">&lt;-</span> <span class="st">"Slope"</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="fu">nrow</span>(lmer_stats)) {</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (lmer_stats<span class="sc">$</span>parameters[i] <span class="sc">==</span> <span class="st">"Slope"</span> <span class="sc">&amp;&amp;</span> lmer_stats<span class="sc">$</span>estimate[i] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove a linha do Slope e a linha do Intercept correspondente</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>    lmer_stats <span class="ot">&lt;-</span> lmer_stats[<span class="sc">-</span><span class="fu">c</span>(i, i <span class="sc">-</span> <span class="dv">1</span>), ]</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Atualiza o índice, pois duas linhas foram removidas</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>lmer_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["experiment"],"name":[1],"type":["chr"],"align":["left"]},{"label":["term"],"name":[2],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["2.5 %"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["97.5 %"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["parameters"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"Exp_1","2":"(Intercept)","3":"9254.90292","4":"281.960969","5":"32.8233477","6":"1.537512e-34","7":"8687.98239","8":"9.821823e+03","9":"Intercept"},{"1":"Exp_1","2":".$sev","3":"-54.89021","4":"10.630335","5":"-5.1635450","6":"4.608472e-06","7":"-76.26393","8":"-3.351649e+01","9":"Slope"},{"1":"Exp_10","2":"(Intercept)","3":"11382.62457","4":"297.630871","5":"38.2440992","6":"1.305901e-37","7":"10784.19760","8":"1.198105e+04","9":"Intercept"},{"1":"Exp_10","2":".$sev","3":"-46.17822","4":"8.914176","5":"-5.1803126","6":"4.350659e-06","7":"-64.10137","8":"-2.825507e+01","9":"Slope"},{"1":"Exp_100","2":"(Intercept)","3":"10388.41183","4":"227.386881","5":"45.6860651","6":"3.213504e-41","7":"9931.21987","8":"1.084560e+04","9":"Intercept"},{"1":"Exp_100","2":".$sev","3":"-43.93695","4":"10.064503","5":"-4.3655365","6":"6.722411e-05","7":"-64.17299","8":"-2.370091e+01","9":"Slope"},{"1":"Exp_101","2":"(Intercept)","3":"9420.46787","4":"234.995929","5":"40.0877917","6":"1.457578e-38","7":"8947.97689","8":"9.892959e+03","9":"Intercept"},{"1":"Exp_101","2":".$sev","3":"-52.81825","4":"6.612579","5":"-7.9875409","6":"2.299657e-10","7":"-66.11373","8":"-3.952277e+01","9":"Slope"},{"1":"Exp_102","2":"(Intercept)","3":"9850.67570","4":"208.160461","5":"47.3225109","6":"6.151265e-42","7":"9432.14104","8":"1.026921e+04","9":"Intercept"},{"1":"Exp_102","2":".$sev","3":"-63.60879","4":"7.251974","5":"-8.7712385","6":"1.543384e-11","7":"-78.18986","8":"-4.902772e+01","9":"Slope"},{"1":"Exp_103","2":"(Intercept)","3":"9243.88918","4":"272.790695","5":"33.8863801","6":"3.542667e-35","7":"8695.40672","8":"9.792372e+03","9":"Intercept"},{"1":"Exp_103","2":".$sev","3":"-53.10046","4":"6.402069","5":"-8.2942663","6":"7.938563e-11","7":"-65.97268","8":"-4.022824e+01","9":"Slope"},{"1":"Exp_104","2":"(Intercept)","3":"9313.73553","4":"308.464612","5":"30.1938542","6":"7.056998e-33","7":"8693.52585","8":"9.933945e+03","9":"Intercept"},{"1":"Exp_104","2":".$sev","3":"-45.85238","4":"18.826669","5":"-2.4355014","6":"1.863529e-02","7":"-83.70593","8":"-7.998824e+00","9":"Slope"},{"1":"Exp_105","2":"(Intercept)","3":"8826.11739","4":"292.998383","5":"30.1234338","6":"7.850627e-33","7":"8237.00466","8":"9.415230e+03","9":"Intercept"},{"1":"Exp_105","2":".$sev","3":"-50.78219","4":"8.592124","5":"-5.9103191","6":"3.435939e-07","7":"-68.05782","8":"-3.350657e+01","9":"Slope"},{"1":"Exp_106","2":"(Intercept)","3":"10498.13139","4":"289.060180","5":"36.3181515","6":"1.438094e-36","7":"9916.93694","8":"1.107933e+04","9":"Intercept"},{"1":"Exp_106","2":".$sev","3":"-61.06125","4":"6.875923","5":"-8.8804444","6":"1.064036e-11","7":"-74.88622","8":"-4.723628e+01","9":"Slope"},{"1":"Exp_107","2":"(Intercept)","3":"10559.71202","4":"256.764121","5":"41.1261199","6":"4.419203e-39","7":"10043.45315","8":"1.107597e+04","9":"Intercept"},{"1":"Exp_107","2":".$sev","3":"-37.32794","4":"6.069000","5":"-6.1505905","6":"1.475771e-07","7":"-49.53048","8":"-2.512539e+01","9":"Slope"},{"1":"Exp_108","2":"(Intercept)","3":"9931.12130","4":"285.621256","5":"34.7702459","6":"1.079344e-35","7":"9356.84128","8":"1.050540e+04","9":"Intercept"},{"1":"Exp_108","2":".$sev","3":"-55.39556","4":"19.207697","5":"-2.8840291","6":"5.861834e-03","7":"-94.01522","8":"-1.677589e+01","9":"Slope"},{"1":"Exp_109","2":"(Intercept)","3":"8685.50728","4":"328.437930","5":"26.4448972","6":"2.872990e-30","7":"8025.13856","8":"9.345876e+03","9":"Intercept"},{"1":"Exp_109","2":".$sev","3":"-44.14543","4":"6.927587","5":"-6.3724103","6":"6.748881e-08","7":"-58.07428","8":"-3.021658e+01","9":"Slope"},{"1":"Exp_11","2":"(Intercept)","3":"10548.51364","4":"246.929366","5":"42.7187492","6":"7.480902e-40","7":"10052.02887","8":"1.104500e+04","9":"Intercept"},{"1":"Exp_11","2":".$sev","3":"-46.81213","4":"6.382305","5":"-7.3346742","6":"2.260506e-09","7":"-59.64461","8":"-3.397964e+01","9":"Slope"},{"1":"Exp_110","2":"(Intercept)","3":"10793.32366","4":"245.618219","5":"43.9434977","6":"1.991137e-40","7":"10299.47513","8":"1.128717e+04","9":"Intercept"},{"1":"Exp_110","2":".$sev","3":"-51.07023","4":"6.655653","5":"-7.6732110","6":"6.888973e-10","7":"-64.45231","8":"-3.768814e+01","9":"Slope"},{"1":"Exp_111","2":"(Intercept)","3":"9917.71744","4":"258.538086","5":"38.3607600","6":"1.133415e-37","7":"9397.89178","8":"1.043754e+04","9":"Intercept"},{"1":"Exp_111","2":".$sev","3":"-53.65372","4":"7.306945","5":"-7.3428386","6":"2.196501e-09","7":"-68.34532","8":"-3.896212e+01","9":"Slope"},{"1":"Exp_112","2":"(Intercept)","3":"11723.60444","4":"280.494821","5":"41.7961529","6":"2.076931e-39","7":"11159.63180","8":"1.228758e+04","9":"Intercept"},{"1":"Exp_112","2":".$sev","3":"-54.00045","4":"9.428962","5":"-5.7270826","6":"6.529641e-07","7":"-72.95865","8":"-3.504225e+01","9":"Slope"},{"1":"Exp_113","2":"(Intercept)","3":"10356.89775","4":"328.152688","5":"31.5612157","6":"9.305416e-34","7":"9697.10255","8":"1.101669e+04","9":"Intercept"},{"1":"Exp_113","2":".$sev","3":"-57.09863","4":"12.226944","5":"-4.6699021","6":"2.456644e-05","7":"-81.68255","8":"-3.251471e+01","9":"Slope"},{"1":"Exp_114","2":"(Intercept)","3":"9723.22438","4":"271.683127","5":"35.7888416","6":"2.838948e-36","7":"9176.96885","8":"1.026948e+04","9":"Intercept"},{"1":"Exp_114","2":".$sev","3":"-74.00138","4":"9.800735","5":"-7.5505949","6":"1.058673e-09","7":"-93.70708","8":"-5.429568e+01","9":"Slope"},{"1":"Exp_115","2":"(Intercept)","3":"7968.55679","4":"300.649873","5":"26.5044409","6":"2.596537e-30","7":"7364.05971","8":"8.573054e+03","9":"Intercept"},{"1":"Exp_115","2":".$sev","3":"-38.96221","4":"7.309894","5":"-5.3300648","6":"2.597148e-06","7":"-53.65974","8":"-2.426468e+01","9":"Slope"},{"1":"Exp_116","2":"(Intercept)","3":"9959.19011","4":"303.736081","5":"32.7889597","6":"1.613450e-34","7":"9348.48779","8":"1.056989e+04","9":"Intercept"},{"1":"Exp_116","2":".$sev","3":"-50.12361","4":"6.373776","5":"-7.8640363","6":"3.536198e-10","7":"-62.93894","8":"-3.730827e+01","9":"Slope"},{"1":"Exp_117","2":"(Intercept)","3":"9110.17229","4":"231.166286","5":"39.4096062","6":"3.228752e-38","7":"8645.38132","8":"9.574963e+03","9":"Intercept"},{"1":"Exp_117","2":".$sev","3":"-78.90158","4":"11.099661","5":"-7.1084675","6":"5.015035e-09","7":"-101.21894","8":"-5.658422e+01","9":"Slope"},{"1":"Exp_118","2":"(Intercept)","3":"11166.15610","4":"285.866893","5":"39.0606831","6":"4.885728e-38","7":"10591.38219","8":"1.174093e+04","9":"Intercept"},{"1":"Exp_118","2":".$sev","3":"-34.99917","4":"15.693321","5":"-2.2301954","6":"3.044531e-02","7":"-66.55271","8":"-3.445636e+00","9":"Slope"},{"1":"Exp_119","2":"(Intercept)","3":"9287.53256","4":"276.028589","5":"33.6469950","6":"4.912088e-35","7":"8732.53988","8":"9.842525e+03","9":"Intercept"},{"1":"Exp_119","2":".$sev","3":"-55.41388","4":"6.655788","5":"-8.3256679","6":"7.122631e-11","7":"-68.79623","8":"-4.203152e+01","9":"Slope"},{"1":"Exp_12","2":"(Intercept)","3":"9571.81386","4":"300.792417","5":"31.8219919","6":"6.380712e-34","7":"8967.03017","8":"1.017660e+04","9":"Intercept"},{"1":"Exp_12","2":".$sev","3":"-54.59917","4":"21.587697","5":"-2.5291800","6":"1.477255e-02","7":"-98.00415","8":"-1.119420e+01","9":"Slope"},{"1":"Exp_120","2":"(Intercept)","3":"10104.34142","4":"290.367950","5":"34.7984046","6":"1.039718e-35","7":"9520.51752","8":"1.068817e+04","9":"Intercept"},{"1":"Exp_120","2":".$sev","3":"-52.20543","4":"9.297812","5":"-5.6148084","6":"9.664114e-07","7":"-70.89994","8":"-3.351093e+01","9":"Slope"},{"1":"Exp_121","2":"(Intercept)","3":"9662.45091","4":"220.506536","5":"43.8193402","6":"2.273406e-40","7":"9219.09281","8":"1.010581e+04","9":"Intercept"},{"1":"Exp_121","2":".$sev","3":"-44.53037","4":"8.140912","5":"-5.4699491","6":"1.599819e-06","7":"-60.89877","8":"-2.816197e+01","9":"Slope"},{"1":"Exp_122","2":"(Intercept)","3":"9333.09258","4":"229.253029","5":"40.7108801","6":"7.097635e-39","7":"8872.14847","8":"9.794037e+03","9":"Intercept"},{"1":"Exp_122","2":".$sev","3":"-60.06593","4":"11.593730","5":"-5.1808975","6":"4.341927e-06","7":"-83.37668","8":"-3.675517e+01","9":"Slope"},{"1":"Exp_123","2":"(Intercept)","3":"11147.83237","4":"310.571979","5":"35.8945208","6":"2.476636e-36","7":"10523.38555","8":"1.177228e+04","9":"Intercept"},{"1":"Exp_123","2":".$sev","3":"-42.49494","4":"10.101750","5":"-4.2066906","6":"1.126227e-04","7":"-62.80587","8":"-2.218401e+01","9":"Slope"},{"1":"Exp_124","2":"(Intercept)","3":"10454.93581","4":"278.228970","5":"37.5767333","6":"2.959820e-37","7":"9895.51897","8":"1.101435e+04","9":"Intercept"},{"1":"Exp_124","2":".$sev","3":"-47.14249","4":"11.501833","5":"-4.0986942","6":"1.592983e-04","7":"-70.26848","8":"-2.401651e+01","9":"Slope"},{"1":"Exp_125","2":"(Intercept)","3":"8624.21551","4":"346.166199","5":"24.9135113","6":"4.159736e-29","7":"7928.20172","8":"9.320229e+03","9":"Intercept"},{"1":"Exp_125","2":".$sev","3":"-50.21483","4":"24.996782","5":"-2.0088517","6":"5.019552e-02","7":"-100.47423","8":"4.457082e-02","9":"Slope"},{"1":"Exp_126","2":"(Intercept)","3":"9961.04626","4":"256.324645","5":"38.8610555","6":"6.202006e-38","7":"9445.67102","8":"1.047642e+04","9":"Intercept"},{"1":"Exp_126","2":".$sev","3":"-55.29437","4":"7.974769","5":"-6.9336638","6":"9.293391e-09","7":"-71.32871","8":"-3.926002e+01","9":"Slope"},{"1":"Exp_127","2":"(Intercept)","3":"9192.24308","4":"233.827984","5":"39.3119889","6":"3.624198e-38","7":"8722.10041","8":"9.662386e+03","9":"Intercept"},{"1":"Exp_127","2":".$sev","3":"-56.66289","4":"18.743230","5":"-3.0231123","6":"4.007363e-03","7":"-94.34868","8":"-1.897710e+01","9":"Slope"},{"1":"Exp_128","2":"(Intercept)","3":"9425.02897","4":"267.664688","5":"35.2120746","6":"6.020983e-36","7":"8886.85304","8":"9.963205e+03","9":"Intercept"},{"1":"Exp_128","2":".$sev","3":"-47.60372","4":"8.790567","5":"-5.4153182","6":"1.933624e-06","7":"-65.27834","8":"-2.992910e+01","9":"Slope"},{"1":"Exp_129","2":"(Intercept)","3":"9013.12209","4":"295.860734","5":"30.4640699","6":"4.698052e-33","7":"8418.25422","8":"9.607990e+03","9":"Intercept"},{"1":"Exp_129","2":".$sev","3":"-45.95743","4":"18.371827","5":"-2.5015164","6":"1.582980e-02","7":"-82.89646","8":"-9.018392e+00","9":"Slope"},{"1":"Exp_13","2":"(Intercept)","3":"9809.24319","4":"244.375625","5":"40.1400229","6":"1.371700e-38","7":"9317.89307","8":"1.030059e+04","9":"Intercept"},{"1":"Exp_13","2":".$sev","3":"-42.99162","4":"5.575611","5":"-7.7106555","6":"6.042895e-10","7":"-54.20213","8":"-3.178110e+01","9":"Slope"},{"1":"Exp_130","2":"(Intercept)","3":"8023.73310","4":"264.088944","5":"30.3826923","6":"5.308645e-33","7":"7492.74669","8":"8.554720e+03","9":"Intercept"},{"1":"Exp_130","2":".$sev","3":"-55.70416","4":"11.438317","5":"-4.8699609","6":"1.253540e-05","7":"-78.70243","8":"-3.270588e+01","9":"Slope"},{"1":"Exp_131","2":"(Intercept)","3":"6678.44679","4":"242.552246","5":"27.5340546","6":"4.655682e-31","7":"6190.76281","8":"7.166131e+03","9":"Intercept"},{"1":"Exp_131","2":".$sev","3":"-65.89323","4":"13.299339","5":"-4.9546245","6":"9.407389e-06","7":"-92.63334","8":"-3.915312e+01","9":"Slope"},{"1":"Exp_132","2":"(Intercept)","3":"9300.02810","4":"213.888246","5":"43.4807815","6":"3.269420e-40","7":"8869.97696","8":"9.730079e+03","9":"Intercept"},{"1":"Exp_132","2":".$sev","3":"-55.86554","4":"7.262408","5":"-7.6924268","6":"6.440878e-10","7":"-70.46759","8":"-4.126349e+01","9":"Slope"},{"1":"Exp_133","2":"(Intercept)","3":"8478.18971","4":"261.813369","5":"32.3825699","6":"2.862323e-34","7":"7951.77865","8":"9.004601e+03","9":"Intercept"},{"1":"Exp_133","2":".$sev","3":"-30.53482","4":"21.158417","5":"-1.4431523","6":"1.554723e-01","7":"-73.07667","8":"1.200703e+01","9":"Slope"},{"1":"Exp_134","2":"(Intercept)","3":"10966.28954","4":"208.853626","5":"52.5070585","6":"4.592914e-44","7":"10546.36118","8":"1.138622e+04","9":"Intercept"},{"1":"Exp_134","2":".$sev","3":"-50.97634","4":"11.253703","5":"-4.5297391","6":"3.916128e-05","7":"-73.60343","8":"-2.834925e+01","9":"Slope"},{"1":"Exp_135","2":"(Intercept)","3":"10625.31924","4":"285.144058","5":"37.2629867","6":"4.368911e-37","7":"10051.99868","8":"1.119864e+04","9":"Intercept"},{"1":"Exp_135","2":".$sev","3":"-51.08902","4":"9.637843","5":"-5.3008774","6":"2.872567e-06","7":"-70.46720","8":"-3.171084e+01","9":"Slope"},{"1":"Exp_136","2":"(Intercept)","3":"10442.67908","4":"269.354137","5":"38.7693287","6":"6.923162e-38","7":"9901.10629","8":"1.098425e+04","9":"Intercept"},{"1":"Exp_136","2":".$sev","3":"-25.84437","4":"23.932931","5":"-1.0798663","6":"2.855980e-01","7":"-73.96475","8":"2.227602e+01","9":"Slope"},{"1":"Exp_137","2":"(Intercept)","3":"9866.51551","4":"368.947934","5":"26.7422978","6":"1.736713e-30","7":"9124.69597","8":"1.060834e+04","9":"Intercept"},{"1":"Exp_137","2":".$sev","3":"-49.02682","4":"7.893756","5":"-6.2108351","6":"1.193456e-07","7":"-64.89828","8":"-3.315536e+01","9":"Slope"},{"1":"Exp_138","2":"(Intercept)","3":"10096.29290","4":"284.207829","5":"35.5243306","6":"4.002092e-36","7":"9524.85476","8":"1.066773e+04","9":"Intercept"},{"1":"Exp_138","2":".$sev","3":"-48.65374","4":"24.014614","5":"-2.0260054","6":"4.834172e-02","7":"-96.93835","8":"-3.691196e-01","9":"Slope"},{"1":"Exp_139","2":"(Intercept)","3":"8357.49225","4":"327.010615","5":"25.5572506","6":"1.329855e-29","7":"7699.99334","8":"9.014991e+03","9":"Intercept"},{"1":"Exp_139","2":".$sev","3":"-43.65988","4":"9.732855","5":"-4.4858240","6":"4.527943e-05","7":"-63.22909","8":"-2.409066e+01","9":"Slope"},{"1":"Exp_14","2":"(Intercept)","3":"9555.36837","4":"234.971498","5":"40.6660741","6":"7.471976e-39","7":"9082.92650","8":"1.002781e+04","9":"Intercept"},{"1":"Exp_14","2":".$sev","3":"-68.66531","4":"14.118423","5":"-4.8635258","6":"1.281122e-05","7":"-97.05231","8":"-4.027832e+01","9":"Slope"},{"1":"Exp_140","2":"(Intercept)","3":"10825.95537","4":"315.946221","5":"34.2651839","6":"2.121328e-35","7":"10190.70291","8":"1.146121e+04","9":"Intercept"},{"1":"Exp_140","2":".$sev","3":"-34.12320","4":"20.006435","5":"-1.7056111","6":"9.454462e-02","7":"-74.34883","8":"6.102436e+00","9":"Slope"},{"1":"Exp_141","2":"(Intercept)","3":"9731.50954","4":"215.799646","5":"45.0951136","6":"5.920081e-41","7":"9297.61527","8":"1.016540e+04","9":"Intercept"},{"1":"Exp_141","2":".$sev","3":"-73.09987","4":"10.598233","5":"-6.8973638","6":"1.056436e-08","7":"-94.40904","8":"-5.179069e+01","9":"Slope"},{"1":"Exp_142","2":"(Intercept)","3":"8858.28712","4":"267.419609","5":"33.1250471","6":"1.009224e-34","7":"8320.60396","8":"9.395970e+03","9":"Intercept"},{"1":"Exp_142","2":".$sev","3":"-35.14625","4":"7.430773","5":"-4.7298244","6":"2.009977e-05","7":"-50.08682","8":"-2.020568e+01","9":"Slope"},{"1":"Exp_143","2":"(Intercept)","3":"11533.76898","4":"259.437581","5":"44.4568167","6":"1.155291e-40","7":"11012.13476","8":"1.205540e+04","9":"Intercept"},{"1":"Exp_143","2":".$sev","3":"-72.47395","4":"13.866670","5":"-5.2264857","6":"3.712060e-06","7":"-100.35476","8":"-4.459315e+01","9":"Slope"},{"1":"Exp_144","2":"(Intercept)","3":"9010.43178","4":"260.013198","5":"34.6537478","6":"1.260363e-35","7":"8487.64021","8":"9.533223e+03","9":"Intercept"},{"1":"Exp_144","2":".$sev","3":"-50.19347","4":"17.786881","5":"-2.8219375","6":"6.924578e-03","7":"-85.95639","8":"-1.443055e+01","9":"Slope"},{"1":"Exp_145","2":"(Intercept)","3":"9873.92506","4":"272.854419","5":"36.1875211","6":"1.699451e-36","7":"9325.31448","8":"1.042254e+04","9":"Intercept"},{"1":"Exp_145","2":".$sev","3":"-54.65232","4":"6.466657","5":"-8.4514032","6":"4.617594e-11","7":"-67.65441","8":"-4.165024e+01","9":"Slope"},{"1":"Exp_146","2":"(Intercept)","3":"9263.06482","4":"328.494030","5":"28.1985789","6":"1.582028e-31","7":"8602.58330","8":"9.923546e+03","9":"Intercept"},{"1":"Exp_146","2":".$sev","3":"-54.55670","4":"17.243038","5":"-3.1639845","6":"2.700048e-03","7":"-89.22616","8":"-1.988725e+01","9":"Slope"},{"1":"Exp_147","2":"(Intercept)","3":"9799.56865","4":"285.321218","5":"34.3457410","6":"1.903427e-35","7":"9225.89190","8":"1.037325e+04","9":"Intercept"},{"1":"Exp_147","2":".$sev","3":"-49.24095","4":"7.652351","5":"-6.4347486","6":"5.415476e-08","7":"-64.62704","8":"-3.385487e+01","9":"Slope"},{"1":"Exp_148","2":"(Intercept)","3":"12210.03464","4":"201.096422","5":"60.7173143","6":"4.761094e-47","7":"11805.70319","8":"1.261437e+04","9":"Intercept"},{"1":"Exp_148","2":".$sev","3":"-49.95791","4":"5.111101","5":"-9.7743947","6":"5.317597e-13","7":"-60.23447","8":"-3.968136e+01","9":"Slope"},{"1":"Exp_149","2":"(Intercept)","3":"9148.31802","4":"288.355464","5":"31.7258355","6":"7.330762e-34","7":"8568.54050","8":"9.728096e+03","9":"Intercept"},{"1":"Exp_149","2":".$sev","3":"-42.82482","4":"5.994527","5":"-7.1439861","6":"4.424692e-09","7":"-54.87762","8":"-3.077201e+01","9":"Slope"},{"1":"Exp_15","2":"(Intercept)","3":"9489.89402","4":"313.445131","5":"30.2760933","6":"6.232908e-33","7":"8859.67034","8":"1.012012e+04","9":"Intercept"},{"1":"Exp_15","2":".$sev","3":"-59.18355","4":"17.911676","5":"-3.3041882","6":"1.806022e-03","7":"-95.19739","8":"-2.316971e+01","9":"Slope"},{"1":"Exp_150","2":"(Intercept)","3":"9709.89024","4":"304.310367","5":"31.9078523","6":"5.638763e-34","7":"9098.03324","8":"1.032175e+04","9":"Intercept"},{"1":"Exp_150","2":".$sev","3":"-65.25719","4":"17.746845","5":"-3.6771146","6":"5.949269e-04","7":"-100.93961","8":"-2.957476e+01","9":"Slope"},{"1":"Exp_151","2":"(Intercept)","3":"8964.97519","4":"297.619564","5":"30.1222644","6":"7.864548e-33","7":"8366.57095","8":"9.563379e+03","9":"Intercept"},{"1":"Exp_151","2":".$sev","3":"-61.74380","4":"21.059172","5":"-2.9319196","6":"5.147962e-03","7":"-104.08611","8":"-1.940150e+01","9":"Slope"},{"1":"Exp_152","2":"(Intercept)","3":"9858.77895","4":"348.180817","5":"28.3151124","6":"1.312263e-31","7":"9158.71450","8":"1.055884e+04","9":"Intercept"},{"1":"Exp_152","2":".$sev","3":"-43.56075","4":"9.356945","5":"-4.6554451","6":"2.578211e-05","7":"-62.37414","8":"-2.474735e+01","9":"Slope"},{"1":"Exp_153","2":"(Intercept)","3":"9347.79171","4":"272.228216","5":"34.3380706","6":"1.923153e-35","7":"8800.44019","8":"9.895143e+03","9":"Intercept"},{"1":"Exp_153","2":".$sev","3":"-63.10907","4":"15.112438","5":"-4.1759690","6":"1.243409e-04","7":"-93.49467","8":"-3.272348e+01","9":"Slope"},{"1":"Exp_154","2":"(Intercept)","3":"10411.92401","4":"280.867407","5":"37.0706026","6":"5.555546e-37","7":"9847.20224","8":"1.097665e+04","9":"Intercept"},{"1":"Exp_154","2":".$sev","3":"-70.01137","4":"11.463098","5":"-6.1075432","6":"1.717391e-07","7":"-93.05947","8":"-4.696326e+01","9":"Slope"},{"1":"Exp_155","2":"(Intercept)","3":"8656.27543","4":"313.029254","5":"27.6532475","6":"3.829748e-31","7":"8026.88793","8":"9.285663e+03","9":"Intercept"},{"1":"Exp_155","2":".$sev","3":"-45.34888","4":"8.058258","5":"-5.6276289","6":"9.241531e-07","7":"-61.55110","8":"-2.914667e+01","9":"Slope"},{"1":"Exp_156","2":"(Intercept)","3":"8043.10447","4":"254.492518","5":"31.6044831","6":"8.739011e-34","7":"7531.41296","8":"8.554796e+03","9":"Intercept"},{"1":"Exp_156","2":".$sev","3":"-48.65503","4":"7.003185","5":"-6.9475577","6":"8.848496e-09","7":"-62.73588","8":"-3.457418e+01","9":"Slope"},{"1":"Exp_157","2":"(Intercept)","3":"10646.19909","4":"266.812973","5":"39.9013547","6":"1.811477e-38","7":"10109.73566","8":"1.118266e+04","9":"Intercept"},{"1":"Exp_157","2":".$sev","3":"-58.31733","4":"5.704604","5":"-10.2228527","6":"1.224839e-13","7":"-69.78721","8":"-4.684745e+01","9":"Slope"},{"1":"Exp_158","2":"(Intercept)","3":"8997.30330","4":"263.948851","5":"34.0872986","6":"2.697202e-35","7":"8466.59857","8":"9.528008e+03","9":"Intercept"},{"1":"Exp_158","2":".$sev","3":"-44.18636","4":"8.504158","5":"-5.1958535","6":"4.124451e-06","7":"-61.28511","8":"-2.708760e+01","9":"Slope"},{"1":"Exp_159","2":"(Intercept)","3":"8858.74524","4":"282.576871","5":"31.3498596","6":"1.266060e-33","7":"8290.58636","8":"9.426904e+03","9":"Intercept"},{"1":"Exp_159","2":".$sev","3":"-30.67429","4":"9.590318","5":"-3.1984647","6":"2.447822e-03","7":"-49.95692","8":"-1.139167e+01","9":"Slope"},{"1":"Exp_16","2":"(Intercept)","3":"8848.35830","4":"291.228888","5":"30.3828318","6":"5.307532e-33","7":"8262.80338","8":"9.433913e+03","9":"Intercept"},{"1":"Exp_16","2":".$sev","3":"-47.89582","4":"6.958371","5":"-6.8831943","6":"1.110647e-08","7":"-61.88656","8":"-3.390508e+01","9":"Slope"},{"1":"Exp_160","2":"(Intercept)","3":"9253.92076","4":"390.805024","5":"23.6791243","6":"3.983346e-28","7":"8468.15460","8":"1.003969e+04","9":"Intercept"},{"1":"Exp_160","2":".$sev","3":"-42.08502","4":"8.374078","5":"-5.0256303","6":"7.387327e-06","7":"-58.92223","8":"-2.524781e+01","9":"Slope"},{"1":"Exp_161","2":"(Intercept)","3":"9584.20412","4":"290.872820","5":"32.9498099","6":"1.288235e-34","7":"8999.36512","8":"1.016904e+04","9":"Intercept"},{"1":"Exp_161","2":".$sev","3":"-53.16996","4":"7.724013","5":"-6.8837225","6":"1.108577e-08","7":"-68.70013","8":"-3.763979e+01","9":"Slope"},{"1":"Exp_162","2":"(Intercept)","3":"10625.71331","4":"266.777411","5":"39.8298838","6":"1.969391e-38","7":"10089.32138","8":"1.116211e+04","9":"Intercept"},{"1":"Exp_162","2":".$sev","3":"-57.41876","4":"14.191145","5":"-4.0460978","6":"1.883636e-04","7":"-85.95197","8":"-2.888555e+01","9":"Slope"},{"1":"Exp_163","2":"(Intercept)","3":"8898.32648","4":"235.874698","5":"37.7248029","6":"2.465556e-37","7":"8424.06862","8":"9.372584e+03","9":"Intercept"},{"1":"Exp_163","2":".$sev","3":"-56.55677","4":"10.892334","5":"-5.1923462","6":"4.174464e-06","7":"-78.45728","8":"-3.465627e+01","9":"Slope"},{"1":"Exp_164","2":"(Intercept)","3":"9967.14583","4":"293.462874","5":"33.9639073","6":"3.188314e-35","7":"9377.09917","8":"1.055719e+04","9":"Intercept"},{"1":"Exp_164","2":".$sev","3":"-44.63235","4":"6.968624","5":"-6.4047576","6":"6.020490e-08","7":"-58.64370","8":"-3.062099e+01","9":"Slope"},{"1":"Exp_165","2":"(Intercept)","3":"7768.21559","4":"286.293300","5":"27.1337666","6":"9.019962e-31","7":"7192.58433","8":"8.343847e+03","9":"Intercept"},{"1":"Exp_165","2":".$sev","3":"-39.81588","4":"7.887202","5":"-5.0481629","6":"6.840626e-06","7":"-55.67417","8":"-2.395760e+01","9":"Slope"},{"1":"Exp_166","2":"(Intercept)","3":"9302.71280","4":"275.557202","5":"33.7596432","6":"4.210751e-35","7":"8748.66792","8":"9.856758e+03","9":"Intercept"},{"1":"Exp_166","2":".$sev","3":"-50.54897","4":"12.656866","5":"-3.9937986","6":"2.223306e-04","7":"-75.99731","8":"-2.510064e+01","9":"Slope"},{"1":"Exp_167","2":"(Intercept)","3":"8556.71695","4":"266.745818","5":"32.0781672","6":"4.416528e-34","7":"8020.38854","8":"9.093045e+03","9":"Intercept"},{"1":"Exp_167","2":".$sev","3":"-46.13944","4":"14.247020","5":"-3.2385326","6":"2.182674e-03","7":"-74.78499","8":"-1.749388e+01","9":"Slope"},{"1":"Exp_168","2":"(Intercept)","3":"9457.37629","4":"234.031914","5":"40.4106266","6":"1.002632e-38","7":"8986.82359","8":"9.927929e+03","9":"Intercept"},{"1":"Exp_168","2":".$sev","3":"-57.15225","4":"11.922363","5":"-4.7937013","6":"1.621560e-05","7":"-81.12376","8":"-3.318073e+01","9":"Slope"},{"1":"Exp_169","2":"(Intercept)","3":"9522.35491","4":"332.598886","5":"28.6301468","6":"7.943353e-32","7":"8853.62003","8":"1.019109e+04","9":"Intercept"},{"1":"Exp_169","2":".$sev","3":"-49.29042","4":"9.770325","5":"-5.0449116","6":"6.916976e-06","7":"-68.93498","8":"-2.964587e+01","9":"Slope"},{"1":"Exp_17","2":"(Intercept)","3":"9485.65304","4":"247.863023","5":"38.2697383","6":"1.265827e-37","7":"8987.29103","8":"9.984015e+03","9":"Intercept"},{"1":"Exp_17","2":".$sev","3":"-53.18111","4":"6.504418","5":"-8.1761530","6":"1.194622e-10","7":"-66.25912","8":"-4.010311e+01","9":"Slope"},{"1":"Exp_170","2":"(Intercept)","3":"9241.48187","4":"242.227051","5":"38.1521463","6":"1.460583e-37","7":"8754.45174","8":"9.728512e+03","9":"Intercept"},{"1":"Exp_170","2":".$sev","3":"-50.54774","4":"10.723784","5":"-4.7136108","6":"2.122290e-05","7":"-72.10936","8":"-2.898613e+01","9":"Slope"},{"1":"Exp_171","2":"(Intercept)","3":"11181.63964","4":"267.927855","5":"41.7337706","6":"2.227110e-39","7":"10642.93458","8":"1.172034e+04","9":"Intercept"},{"1":"Exp_171","2":".$sev","3":"-57.63603","4":"22.983624","5":"-2.5077000","6":"1.558769e-02","7":"-103.84771","8":"-1.142436e+01","9":"Slope"},{"1":"Exp_172","2":"(Intercept)","3":"9097.15205","4":"266.901309","5":"34.0843291","6":"2.708064e-35","7":"8560.51100","8":"9.633793e+03","9":"Intercept"},{"1":"Exp_172","2":".$sev","3":"-33.08188","4":"14.169080","5":"-2.3347941","6":"2.378414e-02","7":"-61.57073","8":"-4.593039e+00","9":"Slope"},{"1":"Exp_173","2":"(Intercept)","3":"10708.76128","4":"351.281861","5":"30.4848114","6":"4.554208e-33","7":"10002.46176","8":"1.141506e+04","9":"Intercept"},{"1":"Exp_173","2":".$sev","3":"-82.99909","4":"23.125483","5":"-3.5890750","6":"7.771431e-04","7":"-129.49599","8":"-3.650219e+01","9":"Slope"},{"1":"Exp_174","2":"(Intercept)","3":"11061.32996","4":"309.828087","5":"35.7015080","6":"3.178938e-36","7":"10438.37883","8":"1.168428e+04","9":"Intercept"},{"1":"Exp_174","2":".$sev","3":"-59.60097","4":"7.537631","5":"-7.9071223","6":"3.042917e-10","7":"-74.75639","8":"-4.444555e+01","9":"Slope"},{"1":"Exp_175","2":"(Intercept)","3":"9157.63134","4":"215.136336","5":"42.5666417","6":"8.839720e-40","7":"8725.07075","8":"9.590192e+03","9":"Intercept"},{"1":"Exp_175","2":".$sev","3":"-55.36823","4":"6.649412","5":"-8.3267862","6":"7.095184e-11","7":"-68.73777","8":"-4.199869e+01","9":"Slope"},{"1":"Exp_176","2":"(Intercept)","3":"9601.60382","4":"256.375602","5":"37.4513165","6":"3.457048e-37","7":"9086.12612","8":"1.011708e+04","9":"Intercept"},{"1":"Exp_176","2":".$sev","3":"-54.07362","4":"7.197117","5":"-7.5132327","6":"1.206967e-09","7":"-68.54439","8":"-3.960284e+01","9":"Slope"},{"1":"Exp_177","2":"(Intercept)","3":"9349.49372","4":"329.454290","5":"28.3787281","6":"1.185285e-31","7":"8687.08148","8":"1.001191e+04","9":"Intercept"},{"1":"Exp_177","2":".$sev","3":"-40.99431","4":"9.103875","5":"-4.5029517","6":"4.278942e-05","7":"-59.29888","8":"-2.268974e+01","9":"Slope"},{"1":"Exp_178","2":"(Intercept)","3":"9241.62183","4":"338.138953","5":"27.3308406","6":"6.506288e-31","7":"8561.74790","8":"9.921496e+03","9":"Intercept"},{"1":"Exp_178","2":".$sev","3":"-45.67087","4":"8.884646","5":"-5.1404271","6":"4.988824e-06","7":"-63.53465","8":"-2.780710e+01","9":"Slope"},{"1":"Exp_179","2":"(Intercept)","3":"9609.85350","4":"228.889877","5":"41.9846156","6":"1.682997e-39","7":"9149.63955","8":"1.007007e+04","9":"Intercept"},{"1":"Exp_179","2":".$sev","3":"-72.58810","4":"10.521061","5":"-6.8993138","6":"1.049186e-08","7":"-93.74211","8":"-5.143409e+01","9":"Slope"},{"1":"Exp_18","2":"(Intercept)","3":"9620.93474","4":"254.623945","5":"37.7848782","6":"2.289832e-37","7":"9108.97899","8":"1.013289e+04","9":"Intercept"},{"1":"Exp_18","2":".$sev","3":"-43.60295","4":"6.126665","5":"-7.1169147","6":"4.867847e-09","7":"-55.92144","8":"-3.128447e+01","9":"Slope"},{"1":"Exp_180","2":"(Intercept)","3":"8856.36667","4":"243.514635","5":"36.3689299","6":"1.347915e-36","7":"8366.74768","8":"9.345986e+03","9":"Intercept"},{"1":"Exp_180","2":".$sev","3":"-41.07813","4":"7.465330","5":"-5.5025207","6":"1.428673e-06","7":"-56.08818","8":"-2.606808e+01","9":"Slope"},{"1":"Exp_181","2":"(Intercept)","3":"10438.10598","4":"259.998113","5":"40.1468528","6":"1.360858e-38","7":"9915.34474","8":"1.096087e+04","9":"Intercept"},{"1":"Exp_181","2":".$sev","3":"-25.21254","4":"12.227801","5":"-2.0619029","6":"4.465339e-02","7":"-49.79818","8":"-6.268969e-01","9":"Slope"},{"1":"Exp_182","2":"(Intercept)","3":"9606.47056","4":"265.378055","5":"36.1991897","6":"1.674252e-36","7":"9072.89222","8":"1.014005e+04","9":"Intercept"},{"1":"Exp_182","2":".$sev","3":"-56.74848","4":"7.037394","5":"-8.0638490","6":"1.763780e-10","7":"-70.89811","8":"-4.259885e+01","9":"Slope"},{"1":"Exp_183","2":"(Intercept)","3":"11001.72900","4":"283.715425","5":"38.7773383","6":"6.856915e-38","7":"10431.28090","8":"1.157218e+04","9":"Intercept"},{"1":"Exp_183","2":".$sev","3":"-50.96098","4":"11.403475","5":"-4.4688990","6":"4.787891e-05","7":"-73.88920","8":"-2.803275e+01","9":"Slope"},{"1":"Exp_184","2":"(Intercept)","3":"9739.94240","4":"254.930357","5":"38.2062870","6":"1.367378e-37","7":"9227.37056","8":"1.025251e+04","9":"Intercept"},{"1":"Exp_184","2":".$sev","3":"-49.02659","4":"7.417542","5":"-6.6095461","6":"2.920493e-08","7":"-63.94056","8":"-3.411262e+01","9":"Slope"},{"1":"Exp_185","2":"(Intercept)","3":"8858.43261","4":"279.871281","5":"31.6518100","6":"8.159599e-34","7":"8295.71368","8":"9.421152e+03","9":"Intercept"},{"1":"Exp_185","2":".$sev","3":"-51.37291","4":"6.922521","5":"-7.4211277","6":"1.667940e-09","7":"-65.29157","8":"-3.745425e+01","9":"Slope"},{"1":"Exp_186","2":"(Intercept)","3":"10060.41092","4":"227.452416","5":"44.2308378","6":"1.467047e-40","7":"9603.08718","8":"1.051773e+04","9":"Intercept"},{"1":"Exp_186","2":".$sev","3":"-41.78968","4":"8.976226","5":"-4.6555953","6":"2.576918e-05","7":"-59.83759","8":"-2.374176e+01","9":"Slope"},{"1":"Exp_187","2":"(Intercept)","3":"10234.65286","4":"281.745600","5":"36.3258658","6":"1.424007e-36","7":"9668.16537","8":"1.080114e+04","9":"Intercept"},{"1":"Exp_187","2":".$sev","3":"-56.45634","4":"6.102653","5":"-9.2511139","6":"3.039097e-12","7":"-68.72654","8":"-4.418613e+01","9":"Slope"},{"1":"Exp_188","2":"(Intercept)","3":"10195.01158","4":"268.376268","5":"37.9877537","6":"1.785317e-37","7":"9655.40493","8":"1.073462e+04","9":"Intercept"},{"1":"Exp_188","2":".$sev","3":"-56.99324","4":"10.874920","5":"-5.2407966","6":"3.533629e-06","7":"-78.85874","8":"-3.512775e+01","9":"Slope"},{"1":"Exp_189","2":"(Intercept)","3":"10531.47340","4":"270.179691","5":"38.9795153","6":"5.382619e-38","7":"9988.24072","8":"1.107471e+04","9":"Intercept"},{"1":"Exp_189","2":".$sev","3":"-57.42554","4":"11.116266","5":"-5.1659013","6":"4.571353e-06","7":"-79.77629","8":"-3.507478e+01","9":"Slope"},{"1":"Exp_19","2":"(Intercept)","3":"9060.64299","4":"288.805520","5":"31.3728179","6":"1.224305e-33","7":"8479.96058","8":"9.641325e+03","9":"Intercept"},{"1":"Exp_19","2":".$sev","3":"-28.89838","4":"18.343399","5":"-1.5754101","6":"1.217306e-01","7":"-65.78025","8":"7.983500e+00","9":"Slope"},{"1":"Exp_190","2":"(Intercept)","3":"9261.38347","4":"231.057884","5":"40.0825253","6":"1.466536e-38","7":"8796.81046","8":"9.725956e+03","9":"Intercept"},{"1":"Exp_190","2":".$sev","3":"-57.59728","4":"6.744977","5":"-8.5392851","6":"3.413683e-11","7":"-71.15897","8":"-4.403560e+01","9":"Slope"},{"1":"Exp_191","2":"(Intercept)","3":"10351.68161","4":"290.585088","5":"35.6235817","6":"3.517300e-36","7":"9767.42114","8":"1.093594e+04","9":"Intercept"},{"1":"Exp_191","2":".$sev","3":"-52.45372","4":"23.773944","5":"-2.2063533","6":"3.217766e-02","7":"-100.25444","8":"-4.653001e+00","9":"Slope"},{"1":"Exp_192","2":"(Intercept)","3":"9059.32054","4":"370.468321","5":"24.4536983","6":"9.541287e-29","7":"8314.44406","8":"9.804197e+03","9":"Intercept"},{"1":"Exp_192","2":".$sev","3":"-33.86208","4":"10.064391","5":"-3.3645431","6":"1.514858e-03","7":"-54.09789","8":"-1.362626e+01","9":"Slope"},{"1":"Exp_193","2":"(Intercept)","3":"9018.68906","4":"298.169831","5":"30.2468195","6":"6.514367e-33","7":"8419.17843","8":"9.618200e+03","9":"Intercept"},{"1":"Exp_193","2":".$sev","3":"-58.44263","4":"11.140654","5":"-5.2458884","6":"3.472210e-06","7":"-80.84241","8":"-3.604284e+01","9":"Slope"},{"1":"Exp_194","2":"(Intercept)","3":"9951.79589","4":"287.640205","5":"34.5980698","6":"1.357536e-35","7":"9373.45649","8":"1.053014e+04","9":"Intercept"},{"1":"Exp_194","2":".$sev","3":"-40.79978","4":"20.041562","5":"-2.0357583","6":"4.731440e-02","7":"-81.09604","8":"-5.035157e-01","9":"Slope"},{"1":"Exp_195","2":"(Intercept)","3":"9993.29363","4":"258.790719","5":"38.6153479","6":"8.331794e-38","7":"9472.96002","8":"1.051363e+04","9":"Intercept"},{"1":"Exp_195","2":".$sev","3":"-43.29404","4":"7.704666","5":"-5.6191978","6":"9.517319e-07","7":"-58.78531","8":"-2.780277e+01","9":"Slope"},{"1":"Exp_196","2":"(Intercept)","3":"9796.89847","4":"272.878179","5":"35.9020956","6":"2.452553e-36","7":"9248.24012","8":"1.034556e+04","9":"Intercept"},{"1":"Exp_196","2":".$sev","3":"-50.86898","4":"9.936255","5":"-5.1195322","6":"5.359165e-06","7":"-70.84716","8":"-3.089080e+01","9":"Slope"},{"1":"Exp_197","2":"(Intercept)","3":"10389.74551","4":"219.052349","5":"47.4304228","6":"5.526579e-42","7":"9949.31125","8":"1.083018e+04","9":"Intercept"},{"1":"Exp_197","2":".$sev","3":"-48.21376","4":"11.640790","5":"-4.1417947","6":"1.387693e-04","7":"-71.61914","8":"-2.480839e+01","9":"Slope"},{"1":"Exp_198","2":"(Intercept)","3":"10031.18896","4":"335.199864","5":"29.9259935","6":"1.059731e-32","7":"9357.22446","8":"1.070515e+04","9":"Intercept"},{"1":"Exp_198","2":".$sev","3":"-64.77288","4":"16.484463","5":"-3.9293288","6":"2.724150e-04","7":"-97.91711","8":"-3.162864e+01","9":"Slope"},{"1":"Exp_199","2":"(Intercept)","3":"8707.72097","4":"230.777767","5":"37.7320619","6":"2.443612e-37","7":"8243.71117","8":"9.171731e+03","9":"Intercept"},{"1":"Exp_199","2":".$sev","3":"-50.32733","4":"9.363605","5":"-5.3747815","6":"2.225061e-06","7":"-69.15412","8":"-3.150054e+01","9":"Slope"},{"1":"Exp_2","2":"(Intercept)","3":"9000.00471","4":"351.768125","5":"25.5850490","6":"1.266664e-29","7":"8292.72749","8":"9.707282e+03","9":"Intercept"},{"1":"Exp_2","2":".$sev","3":"-53.82194","4":"13.892660","5":"-3.8741280","6":"3.238187e-04","7":"-81.75501","8":"-2.588888e+01","9":"Slope"},{"1":"Exp_20","2":"(Intercept)","3":"10045.42912","4":"249.135275","5":"40.3211835","6":"1.111828e-38","7":"9544.50908","8":"1.054635e+04","9":"Intercept"},{"1":"Exp_20","2":".$sev","3":"-59.79156","4":"6.895546","5":"-8.6710409","6":"2.173303e-11","7":"-73.65598","8":"-4.592713e+01","9":"Slope"},{"1":"Exp_200","2":"(Intercept)","3":"8366.57300","4":"338.207437","5":"24.7379924","6":"5.701805e-29","7":"7686.56137","8":"9.046585e+03","9":"Intercept"},{"1":"Exp_200","2":".$sev","3":"-20.72492","4":"24.371661","5":"-0.8503696","6":"3.993416e-01","7":"-69.72743","8":"2.827759e+01","9":"Slope"},{"1":"Exp_21","2":"(Intercept)","3":"11544.57719","4":"275.840544","5":"41.8523580","6":"1.950480e-39","7":"10989.96260","8":"1.209919e+04","9":"Intercept"},{"1":"Exp_21","2":".$sev","3":"-56.44129","4":"7.965687","5":"-7.0855522","6":"5.437181e-09","7":"-72.45738","8":"-4.042521e+01","9":"Slope"},{"1":"Exp_22","2":"(Intercept)","3":"9962.13116","4":"312.349725","5":"31.8941570","6":"5.750931e-34","7":"9334.10995","8":"1.059015e+04","9":"Intercept"},{"1":"Exp_22","2":".$sev","3":"-43.75725","4":"11.444397","5":"-3.8234645","6":"3.791448e-04","7":"-66.76775","8":"-2.074674e+01","9":"Slope"},{"1":"Exp_23","2":"(Intercept)","3":"10618.97874","4":"246.488001","5":"43.0811184","6":"5.037966e-40","7":"10123.38140","8":"1.111458e+04","9":"Intercept"},{"1":"Exp_23","2":".$sev","3":"-43.94431","4":"13.163937","5":"-3.3382347","6":"1.635827e-03","7":"-70.41218","8":"-1.747644e+01","9":"Slope"},{"1":"Exp_24","2":"(Intercept)","3":"9211.64239","4":"280.471597","5":"32.8434055","6":"1.494912e-34","7":"8647.71645","8":"9.775568e+03","9":"Intercept"},{"1":"Exp_24","2":".$sev","3":"-58.75411","4":"8.019614","5":"-7.3263015","6":"2.328089e-09","7":"-74.87862","8":"-4.262959e+01","9":"Slope"},{"1":"Exp_25","2":"(Intercept)","3":"8053.13147","4":"295.900598","5":"27.2156647","6":"7.872946e-31","7":"7458.18345","8":"8.648080e+03","9":"Intercept"},{"1":"Exp_25","2":".$sev","3":"-56.52578","4":"6.849530","5":"-8.2525061","6":"9.171432e-11","7":"-70.29769","8":"-4.275388e+01","9":"Slope"},{"1":"Exp_26","2":"(Intercept)","3":"10486.86646","4":"283.146368","5":"37.0369097","6":"5.795015e-37","7":"9917.56253","8":"1.105617e+04","9":"Intercept"},{"1":"Exp_26","2":".$sev","3":"-51.93951","4":"9.815023","5":"-5.2918374","6":"2.963589e-06","7":"-71.67393","8":"-3.220508e+01","9":"Slope"},{"1":"Exp_27","2":"(Intercept)","3":"11379.95929","4":"302.268064","5":"37.6485665","6":"2.708529e-37","7":"10772.20862","8":"1.198771e+04","9":"Intercept"},{"1":"Exp_27","2":".$sev","3":"-55.51273","4":"17.581878","5":"-3.1573833","6":"2.751049e-03","7":"-90.86346","8":"-2.016199e+01","9":"Slope"},{"1":"Exp_28","2":"(Intercept)","3":"9452.84137","4":"195.289156","5":"48.4043332","6":"2.124481e-42","7":"9060.18620","8":"9.845497e+03","9":"Intercept"},{"1":"Exp_28","2":".$sev","3":"-46.58486","4":"5.127092","5":"-9.0860199","6":"5.300905e-12","7":"-56.89357","8":"-3.627615e+01","9":"Slope"},{"1":"Exp_29","2":"(Intercept)","3":"7479.56988","4":"307.120393","5":"24.3538692","6":"1.144588e-28","7":"6862.06294","8":"8.097077e+03","9":"Intercept"},{"1":"Exp_29","2":".$sev","3":"-28.31156","4":"16.717394","5":"-1.6935391","6":"9.683380e-02","7":"-61.92413","8":"5.301014e+00","9":"Slope"},{"1":"Exp_3","2":"(Intercept)","3":"8559.96416","4":"294.721738","5":"29.0442240","6":"4.136915e-32","7":"7967.38639","8":"9.152542e+03","9":"Intercept"},{"1":"Exp_3","2":".$sev","3":"-38.71551","4":"10.753423","5":"-3.6002967","6":"7.512469e-04","7":"-60.33672","8":"-1.709431e+01","9":"Slope"},{"1":"Exp_30","2":"(Intercept)","3":"7217.04321","4":"250.422275","5":"28.8194938","6":"5.888361e-32","7":"6713.53548","8":"7.720551e+03","9":"Intercept"},{"1":"Exp_30","2":".$sev","3":"-34.19722","4":"6.891404","5":"-4.9623008","6":"9.165115e-06","7":"-48.05331","8":"-2.034112e+01","9":"Slope"},{"1":"Exp_31","2":"(Intercept)","3":"10018.65903","4":"304.487503","5":"32.9033506","6":"1.374633e-34","7":"9406.44588","8":"1.063087e+04","9":"Intercept"},{"1":"Exp_31","2":".$sev","3":"-54.57589","4":"8.269850","5":"-6.5993803","6":"3.027303e-08","7":"-71.20354","8":"-3.794824e+01","9":"Slope"},{"1":"Exp_32","2":"(Intercept)","3":"9661.92821","4":"302.395362","5":"31.9513109","6":"5.297379e-34","7":"9053.92158","8":"1.026993e+04","9":"Intercept"},{"1":"Exp_32","2":".$sev","3":"-39.33842","4":"8.110544","5":"-4.8502810","6":"1.339784e-05","7":"-55.64576","8":"-2.303108e+01","9":"Slope"},{"1":"Exp_33","2":"(Intercept)","3":"9483.94463","4":"307.387953","5":"30.8533387","6":"2.629287e-33","7":"8865.89973","8":"1.010199e+04","9":"Intercept"},{"1":"Exp_33","2":".$sev","3":"-26.16430","4":"10.881817","5":"-2.4044055","6":"2.010622e-02","7":"-48.04366","8":"-4.284942e+00","9":"Slope"},{"1":"Exp_34","2":"(Intercept)","3":"10762.34224","4":"251.048488","5":"42.8695760","6":"6.343388e-40","7":"10257.57542","8":"1.126711e+04","9":"Intercept"},{"1":"Exp_34","2":".$sev","3":"-37.53596","4":"13.210180","5":"-2.8414422","6":"6.572896e-03","7":"-64.09681","8":"-1.097512e+01","9":"Slope"},{"1":"Exp_35","2":"(Intercept)","3":"8541.05225","4":"202.197376","5":"42.2411627","6":"1.265815e-39","7":"8134.50717","8":"8.947597e+03","9":"Intercept"},{"1":"Exp_35","2":".$sev","3":"-39.70532","4":"12.808249","5":"-3.0999799","6":"3.234408e-03","7":"-65.45803","8":"-1.395260e+01","9":"Slope"},{"1":"Exp_36","2":"(Intercept)","3":"10478.09632","4":"248.107955","5":"42.2320047","6":"1.278716e-39","7":"9979.24185","8":"1.097695e+04","9":"Intercept"},{"1":"Exp_36","2":".$sev","3":"-55.93122","4":"14.597982","5":"-3.8314350","6":"3.698738e-04","7":"-85.28243","8":"-2.658001e+01","9":"Slope"},{"1":"Exp_37","2":"(Intercept)","3":"9411.01470","4":"281.422462","5":"33.4408797","6":"6.519620e-35","7":"8845.17692","8":"9.976852e+03","9":"Intercept"},{"1":"Exp_37","2":".$sev","3":"-40.67659","4":"8.969566","5":"-4.5349560","6":"3.849056e-05","7":"-58.71111","8":"-2.264207e+01","9":"Slope"},{"1":"Exp_38","2":"(Intercept)","3":"7694.23747","4":"260.878223","5":"29.4935982","6":"2.057112e-32","7":"7169.70665","8":"8.218768e+03","9":"Intercept"},{"1":"Exp_38","2":".$sev","3":"-32.68318","4":"16.818710","5":"-1.9432634","6":"5.786098e-02","7":"-66.49947","8":"1.133099e+00","9":"Slope"},{"1":"Exp_39","2":"(Intercept)","3":"11016.62212","4":"209.629286","5":"52.5528773","6":"4.407680e-44","7":"10595.13419","8":"1.143811e+04","9":"Intercept"},{"1":"Exp_39","2":".$sev","3":"-55.65585","4":"12.801309","5":"-4.3476685","6":"7.126583e-05","7":"-81.39461","8":"-2.991709e+01","9":"Slope"},{"1":"Exp_4","2":"(Intercept)","3":"9022.82345","4":"252.952865","5":"35.6699793","6":"3.311648e-36","7":"8514.22762","8":"9.531419e+03","9":"Intercept"},{"1":"Exp_4","2":".$sev","3":"-58.11925","4":"10.158874","5":"-5.7210326","6":"6.669248e-07","7":"-78.54503","8":"-3.769346e+01","9":"Slope"},{"1":"Exp_40","2":"(Intercept)","3":"10950.09084","4":"303.966366","5":"36.0240213","6":"2.096149e-36","7":"10338.92550","8":"1.156126e+04","9":"Intercept"},{"1":"Exp_40","2":".$sev","3":"-53.36113","4":"7.284897","5":"-7.3248975","6":"2.339619e-09","7":"-68.00839","8":"-3.871386e+01","9":"Slope"},{"1":"Exp_41","2":"(Intercept)","3":"9794.13997","4":"315.685432","5":"31.0249983","6":"2.039810e-33","7":"9159.41187","8":"1.042887e+04","9":"Intercept"},{"1":"Exp_41","2":".$sev","3":"-51.92806","4":"24.282146","5":"-2.1385285","6":"3.759089e-02","7":"-100.75059","8":"-3.105535e+00","9":"Slope"},{"1":"Exp_42","2":"(Intercept)","3":"10494.05045","4":"313.176772","5":"33.5083933","6":"5.941159e-35","7":"9864.36635","8":"1.112373e+04","9":"Intercept"},{"1":"Exp_42","2":".$sev","3":"-48.49479","4":"11.824710","5":"-4.1011403","6":"1.580582e-04","7":"-72.26996","8":"-2.471962e+01","9":"Slope"},{"1":"Exp_43","2":"(Intercept)","3":"10978.11590","4":"287.047149","5":"38.2449920","6":"1.304484e-37","7":"10400.96893","8":"1.155526e+04","9":"Intercept"},{"1":"Exp_43","2":".$sev","3":"-32.99070","4":"6.627499","5":"-4.9778502","6":"8.693034e-06","7":"-46.31618","8":"-1.966522e+01","9":"Slope"},{"1":"Exp_44","2":"(Intercept)","3":"10319.37642","4":"276.757474","5":"37.2867127","6":"4.241686e-37","7":"9762.91823","8":"1.087583e+04","9":"Intercept"},{"1":"Exp_44","2":".$sev","3":"-62.58611","4":"21.493025","5":"-2.9119265","6":"5.435530e-03","7":"-105.80073","8":"-1.937149e+01","9":"Slope"},{"1":"Exp_45","2":"(Intercept)","3":"7815.75252","4":"266.233346","5":"29.3567753","6":"2.542142e-32","7":"7280.45451","8":"8.351051e+03","9":"Intercept"},{"1":"Exp_45","2":".$sev","3":"-41.64621","4":"7.767786","5":"-5.3614000","6":"2.330502e-06","7":"-57.26439","8":"-2.602803e+01","9":"Slope"},{"1":"Exp_46","2":"(Intercept)","3":"9286.58600","4":"300.772044","5":"30.8758283","6":"2.543094e-33","7":"8681.84328","8":"9.891329e+03","9":"Intercept"},{"1":"Exp_46","2":".$sev","3":"-46.71294","4":"6.477977","5":"-7.2110374","6":"3.493446e-09","7":"-59.73778","8":"-3.368809e+01","9":"Slope"},{"1":"Exp_47","2":"(Intercept)","3":"9460.49710","4":"250.546685","5":"37.7594184","6":"2.362688e-37","7":"8956.73923","8":"9.964255e+03","9":"Intercept"},{"1":"Exp_47","2":".$sev","3":"-35.59344","4":"18.852616","5":"-1.8879839","6":"6.508081e-02","7":"-73.49916","8":"2.312289e+00","9":"Slope"},{"1":"Exp_48","2":"(Intercept)","3":"8983.76265","4":"260.683852","5":"34.4622906","6":"1.627847e-35","7":"8459.62264","8":"9.507903e+03","9":"Intercept"},{"1":"Exp_48","2":".$sev","3":"-35.27978","4":"6.482367","5":"-5.4424231","6":"1.760181e-06","7":"-48.31346","8":"-2.224611e+01","9":"Slope"},{"1":"Exp_49","2":"(Intercept)","3":"10524.23934","4":"337.865737","5":"31.1491761","6":"1.698952e-33","7":"9844.91474","8":"1.120356e+04","9":"Intercept"},{"1":"Exp_49","2":".$sev","3":"-52.51616","4":"8.520568","5":"-6.1634577","6":"1.410358e-07","7":"-69.64791","8":"-3.538441e+01","9":"Slope"},{"1":"Exp_5","2":"(Intercept)","3":"8017.11336","4":"322.262950","5":"24.8775522","6":"4.436647e-29","7":"7369.16027","8":"8.665066e+03","9":"Intercept"},{"1":"Exp_5","2":".$sev","3":"-60.14465","4":"9.132289","5":"-6.5859330","6":"3.174616e-08","7":"-78.50634","8":"-4.178295e+01","9":"Slope"},{"1":"Exp_50","2":"(Intercept)","3":"8745.73298","4":"221.593665","5":"39.4674324","6":"3.015547e-38","7":"8300.18906","8":"9.191277e+03","9":"Intercept"},{"1":"Exp_50","2":".$sev","3":"-44.18657","4":"5.229402","5":"-8.4496407","6":"4.645687e-11","7":"-54.70099","8":"-3.367215e+01","9":"Slope"},{"1":"Exp_51","2":"(Intercept)","3":"9902.93741","4":"261.078265","5":"37.9309147","6":"1.914007e-37","7":"9378.00437","8":"1.042787e+04","9":"Intercept"},{"1":"Exp_51","2":".$sev","3":"-54.07793","4":"6.174831","5":"-8.7577993","6":"1.615796e-11","7":"-66.49326","8":"-4.166260e+01","9":"Slope"},{"1":"Exp_52","2":"(Intercept)","3":"10720.64188","4":"317.571951","5":"33.7581511","6":"4.219339e-35","7":"10082.12068","8":"1.135916e+04","9":"Intercept"},{"1":"Exp_52","2":".$sev","3":"-67.47288","4":"17.844264","5":"-3.7812081","6":"4.321585e-04","7":"-103.35117","8":"-3.159458e+01","9":"Slope"},{"1":"Exp_53","2":"(Intercept)","3":"11286.21282","4":"281.525138","5":"40.0895384","6":"1.454619e-38","7":"10720.16859","8":"1.185226e+04","9":"Intercept"},{"1":"Exp_53","2":".$sev","3":"-50.15843","4":"14.356754","5":"-3.4937167","6":"1.034431e-03","7":"-79.02462","8":"-2.129224e+01","9":"Slope"},{"1":"Exp_54","2":"(Intercept)","3":"11358.25862","4":"286.962448","5":"39.5809929","6":"2.637673e-38","7":"10781.28195","8":"1.193524e+04","9":"Intercept"},{"1":"Exp_54","2":".$sev","3":"-51.85185","4":"6.970901","5":"-7.4383278","6":"1.570115e-09","7":"-65.86778","8":"-3.783591e+01","9":"Slope"},{"1":"Exp_55","2":"(Intercept)","3":"9281.88002","4":"276.838671","5":"33.5281195","6":"5.782231e-35","7":"8725.25857","8":"9.838501e+03","9":"Intercept"},{"1":"Exp_55","2":".$sev","3":"-47.18063","4":"7.754277","5":"-6.0844652","6":"1.862760e-07","7":"-62.77165","8":"-3.158961e+01","9":"Slope"},{"1":"Exp_56","2":"(Intercept)","3":"9785.40628","4":"266.334820","5":"36.7409950","6":"8.408033e-37","7":"9249.90424","8":"1.032091e+04","9":"Intercept"},{"1":"Exp_56","2":".$sev","3":"-35.62746","4":"8.898968","5":"-4.0035497","6":"2.155774e-04","7":"-53.52004","8":"-1.773489e+01","9":"Slope"},{"1":"Exp_57","2":"(Intercept)","3":"9142.02510","4":"232.538134","5":"39.3140899","6":"3.615186e-38","7":"8674.47584","8":"9.609574e+03","9":"Intercept"},{"1":"Exp_57","2":".$sev","3":"-44.86820","4":"5.289110","5":"-8.4831277","6":"4.140197e-11","7":"-55.50267","8":"-3.423373e+01","9":"Slope"},{"1":"Exp_58","2":"(Intercept)","3":"9912.48439","4":"304.352898","5":"32.5690488","6":"2.198491e-34","7":"9300.54188","8":"1.052443e+04","9":"Intercept"},{"1":"Exp_58","2":".$sev","3":"-49.56622","4":"8.605898","5":"-5.7595637","6":"5.828290e-07","7":"-66.86954","8":"-3.226290e+01","9":"Slope"},{"1":"Exp_59","2":"(Intercept)","3":"8955.39332","4":"235.975935","5":"37.9504517","6":"1.868739e-37","7":"8480.93191","8":"9.429855e+03","9":"Intercept"},{"1":"Exp_59","2":".$sev","3":"-57.25122","4":"6.156935","5":"-9.2986558","6":"2.590654e-12","7":"-69.63056","8":"-4.487187e+01","9":"Slope"},{"1":"Exp_6","2":"(Intercept)","3":"8863.21612","4":"298.462061","5":"29.6962906","6":"1.505756e-32","7":"8263.11793","8":"9.463314e+03","9":"Intercept"},{"1":"Exp_6","2":".$sev","3":"-52.32518","4":"12.006245","5":"-4.3581632","6":"6.886409e-05","7":"-76.46535","8":"-2.818500e+01","9":"Slope"},{"1":"Exp_60","2":"(Intercept)","3":"8417.92730","4":"287.483821","5":"29.2813949","6":"2.857710e-32","7":"7839.90234","8":"8.995952e+03","9":"Intercept"},{"1":"Exp_60","2":".$sev","3":"-48.63734","4":"7.354779","5":"-6.6130259","6":"2.884804e-08","7":"-63.42512","8":"-3.384957e+01","9":"Slope"},{"1":"Exp_61","2":"(Intercept)","3":"9410.69144","4":"315.868856","5":"29.7930336","6":"1.298294e-32","7":"8775.59454","8":"1.004579e+04","9":"Intercept"},{"1":"Exp_61","2":".$sev","3":"-62.74974","4":"25.260887","5":"-2.4840671","6":"1.653151e-02","7":"-113.54015","8":"-1.195932e+01","9":"Slope"},{"1":"Exp_62","2":"(Intercept)","3":"8912.12444","4":"283.612966","5":"31.4235438","6":"1.136956e-33","7":"8341.88235","8":"9.482367e+03","9":"Intercept"},{"1":"Exp_62","2":".$sev","3":"-59.09424","4":"11.396035","5":"-5.1855091","6":"4.273689e-06","7":"-82.00750","8":"-3.618098e+01","9":"Slope"},{"1":"Exp_63","2":"(Intercept)","3":"9661.78401","4":"313.397443","5":"30.8291730","6":"2.725228e-33","7":"9031.65622","8":"1.029191e+04","9":"Intercept"},{"1":"Exp_63","2":".$sev","3":"-68.88652","4":"19.288809","5":"-3.5713208","6":"8.198681e-04","7":"-107.66927","8":"-3.010377e+01","9":"Slope"},{"1":"Exp_64","2":"(Intercept)","3":"10224.48390","4":"297.166498","5":"34.4065834","6":"1.754091e-35","7":"9626.99061","8":"1.082198e+04","9":"Intercept"},{"1":"Exp_64","2":".$sev","3":"-32.54940","4":"21.519253","5":"-1.5125710","6":"1.369454e-01","7":"-75.81675","8":"1.071796e+01","9":"Slope"},{"1":"Exp_65","2":"(Intercept)","3":"7676.03521","4":"306.175151","5":"25.0707322","6":"3.141220e-29","7":"7060.42881","8":"8.291642e+03","9":"Intercept"},{"1":"Exp_65","2":".$sev","3":"-50.10554","4":"7.646791","5":"-6.5524920","6":"3.572768e-08","7":"-65.48044","8":"-3.473063e+01","9":"Slope"},{"1":"Exp_66","2":"(Intercept)","3":"10194.95806","4":"243.447828","5":"41.8773835","6":"1.896731e-39","7":"9705.47340","8":"1.068444e+04","9":"Intercept"},{"1":"Exp_66","2":".$sev","3":"-52.17322","4":"9.585075","5":"-5.4431733","6":"1.755606e-06","7":"-71.44531","8":"-3.290114e+01","9":"Slope"},{"1":"Exp_67","2":"(Intercept)","3":"8351.84541","4":"259.306206","5":"32.2084286","6":"3.666715e-34","7":"7830.47534","8":"8.873215e+03","9":"Intercept"},{"1":"Exp_67","2":".$sev","3":"-46.15535","4":"21.178080","5":"-2.1793925","6":"3.424106e-02","7":"-88.73673","8":"-3.573965e+00","9":"Slope"},{"1":"Exp_68","2":"(Intercept)","3":"10396.44240","4":"232.452133","5":"44.7250892","6":"8.713081e-41","7":"9929.06606","8":"1.086382e+04","9":"Intercept"},{"1":"Exp_68","2":".$sev","3":"-44.71513","4":"7.383894","5":"-6.0557648","6":"2.060754e-07","7":"-59.56144","8":"-2.986881e+01","9":"Slope"},{"1":"Exp_69","2":"(Intercept)","3":"10450.82818","4":"262.016594","5":"39.8861309","6":"1.843995e-38","7":"9924.00850","8":"1.097765e+04","9":"Intercept"},{"1":"Exp_69","2":".$sev","3":"-23.28905","4":"22.410267","5":"-1.0392133","6":"3.039122e-01","7":"-68.34791","8":"2.176981e+01","9":"Slope"},{"1":"Exp_7","2":"(Intercept)","3":"9199.25073","4":"239.470216","5":"38.4150100","6":"1.061304e-37","7":"8717.76359","8":"9.680738e+03","9":"Intercept"},{"1":"Exp_7","2":".$sev","3":"-46.54152","4":"6.114111","5":"-7.6121486","6":"8.531740e-10","7":"-58.83476","8":"-3.424827e+01","9":"Slope"},{"1":"Exp_70","2":"(Intercept)","3":"9823.72092","4":"297.059321","5":"33.0698963","6":"1.089669e-34","7":"9226.44312","8":"1.042100e+04","9":"Intercept"},{"1":"Exp_70","2":".$sev","3":"-47.57426","4":"10.319066","5":"-4.6103263","6":"2.996785e-05","7":"-68.32213","8":"-2.682639e+01","9":"Slope"},{"1":"Exp_71","2":"(Intercept)","3":"9868.45727","4":"230.548634","5":"42.8042322","6":"6.812802e-40","7":"9404.90817","8":"1.033201e+04","9":"Intercept"},{"1":"Exp_71","2":".$sev","3":"-47.84271","4":"7.436490","5":"-6.4335072","6":"5.439271e-08","7":"-62.79478","8":"-3.289065e+01","9":"Slope"},{"1":"Exp_72","2":"(Intercept)","3":"9488.57071","4":"327.138079","5":"29.0047883","6":"4.400520e-32","7":"8830.81552","8":"1.014633e+04","9":"Intercept"},{"1":"Exp_72","2":".$sev","3":"-53.05399","4":"13.567948","5":"-3.9102442","6":"2.892249e-04","7":"-80.33418","8":"-2.577380e+01","9":"Slope"},{"1":"Exp_73","2":"(Intercept)","3":"9754.72835","4":"316.311793","5":"30.8389651","6":"2.685929e-33","7":"9118.74086","8":"1.039072e+04","9":"Intercept"},{"1":"Exp_73","2":".$sev","3":"-57.27447","4":"8.524453","5":"-6.7188440","6":"1.984862e-08","7":"-74.41403","8":"-4.013491e+01","9":"Slope"},{"1":"Exp_74","2":"(Intercept)","3":"9141.30631","4":"249.364693","5":"36.6583825","6":"9.333347e-37","7":"8639.92499","8":"9.642688e+03","9":"Intercept"},{"1":"Exp_74","2":".$sev","3":"-53.93666","4":"7.905033","5":"-6.8230778","6":"1.373395e-08","7":"-69.83079","8":"-3.804252e+01","9":"Slope"},{"1":"Exp_75","2":"(Intercept)","3":"9541.02853","4":"295.704705","5":"32.2653930","6":"3.380918e-34","7":"8946.47438","8":"1.013558e+04","9":"Intercept"},{"1":"Exp_75","2":".$sev","3":"-49.39757","4":"6.270118","5":"-7.8782519","6":"3.365140e-10","7":"-62.00449","8":"-3.679065e+01","9":"Slope"},{"1":"Exp_76","2":"(Intercept)","3":"9430.72230","4":"249.433273","5":"37.8085978","6":"2.224017e-37","7":"8929.20309","8":"9.932242e+03","9":"Intercept"},{"1":"Exp_76","2":".$sev","3":"-47.87430","4":"7.848521","5":"-6.0997862","6":"1.764945e-07","7":"-63.65481","8":"-3.209379e+01","9":"Slope"},{"1":"Exp_77","2":"(Intercept)","3":"9447.25744","4":"276.004081","5":"34.2286875","6":"2.228267e-35","7":"8892.31404","8":"1.000220e+04","9":"Intercept"},{"1":"Exp_77","2":".$sev","3":"-23.56598","4":"12.229559","5":"-1.9269691","6":"5.991416e-02","7":"-48.15516","8":"1.023194e+00","9":"Slope"},{"1":"Exp_78","2":"(Intercept)","3":"9243.22360","4":"285.009113","5":"32.4313265","6":"2.671154e-34","7":"8670.17437","8":"9.816273e+03","9":"Intercept"},{"1":"Exp_78","2":".$sev","3":"-53.69209","4":"7.766347","5":"-6.9134287","6":"9.981712e-09","7":"-69.30737","8":"-3.807680e+01","9":"Slope"},{"1":"Exp_79","2":"(Intercept)","3":"11114.30444","4":"276.199046","5":"40.2401985","6":"1.221149e-38","7":"10558.96904","8":"1.166964e+04","9":"Intercept"},{"1":"Exp_79","2":".$sev","3":"-43.35869","4":"11.232129","5":"-3.8602378","6":"3.381594e-04","7":"-65.94240","8":"-2.077498e+01","9":"Slope"},{"1":"Exp_8","2":"(Intercept)","3":"10498.70691","4":"264.841771","5":"39.6414315","6":"2.456628e-38","7":"9966.20684","8":"1.103121e+04","9":"Intercept"},{"1":"Exp_8","2":".$sev","3":"-50.90924","4":"7.053032","5":"-7.2180646","6":"3.408021e-09","7":"-65.09032","8":"-3.672817e+01","9":"Slope"},{"1":"Exp_80","2":"(Intercept)","3":"10047.72496","4":"341.043835","5":"29.4616818","6":"2.161080e-32","7":"9362.01037","8":"1.073344e+04","9":"Intercept"},{"1":"Exp_80","2":".$sev","3":"-61.88363","4":"12.399036","5":"-4.9910030","6":"8.312476e-06","7":"-86.81356","8":"-3.695369e+01","9":"Slope"},{"1":"Exp_81","2":"(Intercept)","3":"7892.59835","4":"260.668707","5":"30.2782733","6":"6.212451e-33","7":"7368.48879","8":"8.416708e+03","9":"Intercept"},{"1":"Exp_81","2":".$sev","3":"-52.14422","4":"19.997152","5":"-2.6075825","6":"1.211562e-02","7":"-92.35119","8":"-1.193725e+01","9":"Slope"},{"1":"Exp_82","2":"(Intercept)","3":"10981.85292","4":"292.822376","5":"37.5034622","6":"3.240706e-37","7":"10393.09407","8":"1.157061e+04","9":"Intercept"},{"1":"Exp_82","2":".$sev","3":"-45.34664","4":"15.391050","5":"-2.9462991","6":"4.949973e-03","7":"-76.29242","8":"-1.440086e+01","9":"Slope"},{"1":"Exp_83","2":"(Intercept)","3":"10167.33917","4":"256.817062","5":"39.5898119","6":"2.610430e-38","7":"9650.97386","8":"1.068370e+04","9":"Intercept"},{"1":"Exp_83","2":".$sev","3":"-46.88675","4":"16.752941","5":"-2.7987173","6":"7.365957e-03","7":"-80.57079","8":"-1.320270e+01","9":"Slope"},{"1":"Exp_84","2":"(Intercept)","3":"10094.08850","4":"281.864178","5":"35.8118884","6":"2.755575e-36","7":"9527.36258","8":"1.066081e+04","9":"Intercept"},{"1":"Exp_84","2":".$sev","3":"-47.61792","4":"11.539738","5":"-4.1264297","6":"1.457744e-04","7":"-70.82012","8":"-2.441572e+01","9":"Slope"},{"1":"Exp_85","2":"(Intercept)","3":"10906.02959","4":"276.265218","5":"39.4766655","6":"2.982859e-38","7":"10350.56114","8":"1.146150e+04","9":"Intercept"},{"1":"Exp_85","2":".$sev","3":"-50.89958","4":"8.527672","5":"-5.9687548","6":"2.798393e-07","7":"-68.04562","8":"-3.375355e+01","9":"Slope"},{"1":"Exp_86","2":"(Intercept)","3":"10020.43516","4":"265.924538","5":"37.6814988","6":"2.600706e-37","7":"9485.75804","8":"1.055511e+04","9":"Intercept"},{"1":"Exp_86","2":".$sev","3":"-63.06130","4":"16.881677","5":"-3.7354879","6":"4.975400e-04","7":"-97.00419","8":"-2.911841e+01","9":"Slope"},{"1":"Exp_87","2":"(Intercept)","3":"9665.21885","4":"272.243756","5":"35.5020772","6":"4.119841e-36","7":"9117.83609","8":"1.021260e+04","9":"Intercept"},{"1":"Exp_87","2":".$sev","3":"-44.08540","4":"6.696076","5":"-6.5837669","6":"3.199005e-08","7":"-57.54876","8":"-3.062204e+01","9":"Slope"},{"1":"Exp_88","2":"(Intercept)","3":"12534.32291","4":"276.508174","5":"45.3307500","6":"4.635818e-41","7":"11978.36597","8":"1.309028e+04","9":"Intercept"},{"1":"Exp_88","2":".$sev","3":"-67.68761","4":"12.457655","5":"-5.4334152","6":"1.816041e-06","7":"-92.73541","8":"-4.263982e+01","9":"Slope"},{"1":"Exp_89","2":"(Intercept)","3":"9603.27679","4":"250.234045","5":"38.3771793","6":"1.111077e-37","7":"9100.14752","8":"1.010641e+04","9":"Intercept"},{"1":"Exp_89","2":".$sev","3":"-39.57568","4":"16.791761","5":"-2.3568511","6":"2.255832e-02","7":"-73.33778","8":"-5.813582e+00","9":"Slope"},{"1":"Exp_9","2":"(Intercept)","3":"11101.64988","4":"202.704138","5":"54.7677517","6":"6.273127e-45","7":"10694.08589","8":"1.150921e+04","9":"Intercept"},{"1":"Exp_9","2":".$sev","3":"-50.64882","4":"7.533429","5":"-6.7232091","6":"1.954483e-08","7":"-65.79579","8":"-3.550185e+01","9":"Slope"},{"1":"Exp_90","2":"(Intercept)","3":"8050.70144","4":"282.703331","5":"28.4775613","6":"1.012351e-31","7":"7482.28830","8":"8.619115e+03","9":"Intercept"},{"1":"Exp_90","2":".$sev","3":"-50.60910","4":"6.317657","5":"-8.0107381","6":"2.121374e-10","7":"-63.31160","8":"-3.790660e+01","9":"Slope"},{"1":"Exp_91","2":"(Intercept)","3":"10496.46972","4":"285.291647","5":"36.7920681","6":"7.883332e-37","7":"9922.85242","8":"1.107009e+04","9":"Intercept"},{"1":"Exp_91","2":".$sev","3":"-45.49343","4":"10.742086","5":"-4.2350645","6":"1.027586e-04","7":"-67.09184","8":"-2.389502e+01","9":"Slope"},{"1":"Exp_92","2":"(Intercept)","3":"8905.37502","4":"308.503817","5":"28.8663366","6":"5.469516e-32","7":"8285.08653","8":"9.525664e+03","9":"Intercept"},{"1":"Exp_92","2":".$sev","3":"-55.41604","4":"11.258685","5":"-4.9220704","6":"1.050685e-05","7":"-78.05314","8":"-3.277894e+01","9":"Slope"},{"1":"Exp_93","2":"(Intercept)","3":"11800.15197","4":"318.259149","5":"37.0771806","6":"5.509984e-37","7":"11160.24907","8":"1.244005e+04","9":"Intercept"},{"1":"Exp_93","2":".$sev","3":"-35.07618","4":"10.679625","5":"-3.2844013","6":"1.912509e-03","7":"-56.54900","8":"-1.360335e+01","9":"Slope"},{"1":"Exp_94","2":"(Intercept)","3":"8975.51399","4":"235.413337","5":"38.1266164","6":"1.506758e-37","7":"8502.18375","8":"9.448844e+03","9":"Intercept"},{"1":"Exp_94","2":".$sev","3":"-16.72920","4":"17.119873","5":"-0.9771800","6":"3.333794e-01","7":"-51.15101","8":"1.769261e+01","9":"Slope"},{"1":"Exp_95","2":"(Intercept)","3":"10970.54507","4":"295.136321","5":"37.1711114","6":"4.899429e-37","7":"10377.13373","8":"1.156396e+04","9":"Intercept"},{"1":"Exp_95","2":".$sev","3":"-59.76675","4":"7.092357","5":"-8.4269238","6":"5.023583e-11","7":"-74.02689","8":"-4.550661e+01","9":"Slope"},{"1":"Exp_96","2":"(Intercept)","3":"9799.67541","4":"225.119288","5":"43.5310342","6":"3.097245e-40","7":"9347.04275","8":"1.025231e+04","9":"Intercept"},{"1":"Exp_96","2":".$sev","3":"-55.89559","4":"13.298329","5":"-4.2032041","6":"1.138965e-04","7":"-82.63367","8":"-2.915751e+01","9":"Slope"},{"1":"Exp_97","2":"(Intercept)","3":"9692.71067","4":"222.227807","5":"43.6161019","6":"2.826582e-40","7":"9245.89171","8":"1.013953e+04","9":"Intercept"},{"1":"Exp_97","2":".$sev","3":"-46.46322","4":"12.681824","5":"-3.6637645","6":"6.196433e-04","7":"-71.96173","8":"-2.096470e+01","9":"Slope"},{"1":"Exp_98","2":"(Intercept)","3":"9950.04168","4":"304.382263","5":"32.6892953","6":"1.855878e-34","7":"9338.04013","8":"1.056204e+04","9":"Intercept"},{"1":"Exp_98","2":".$sev","3":"-46.67514","4":"6.458823","5":"-7.2265713","6":"3.307407e-09","7":"-59.66147","8":"-3.368881e+01","9":"Slope"},{"1":"Exp_99","2":"(Intercept)","3":"10429.51130","4":"186.141723","5":"56.0299492","6":"2.136380e-45","7":"10055.24828","8":"1.080377e+04","9":"Intercept"},{"1":"Exp_99","2":".$sev","3":"-37.54916","4":"10.336079","5":"-3.6328249","6":"6.807679e-04","7":"-58.33124","8":"-1.676709e+01","9":"Slope"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>slope_trial_m<span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Slope"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Slope =</span> estimate</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>slope_trial_m[,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>slope_trial_m <span class="sc">|&gt;</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Slope <span class="sc">==</span> <span class="st">"NA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="at">mean =</span> <span class="fu">mean</span>(Slope))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"-49.57446"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>intercept_trial_m <span class="ot">=</span> lmer_stats <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Intercept =</span> estimate</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>intercept_trial_m[,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(intercept_trial_m<span class="sc">$</span>Intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9692.539</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>regression_trial_m <span class="ot">=</span> <span class="fu">cbind</span>(slope_trial_m,intercept_trial_m)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>regression_trial_m[,<span class="dv">3</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> regression_trial_m <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_intercept =</span> <span class="fu">mean</span>(Intercept),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_slope =</span> <span class="fu">mean</span>(Slope),</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_intercept_lower =</span> <span class="fu">quantile</span>(Intercept, <span class="fl">0.025</span>),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_intercept_upper =</span> <span class="fu">quantile</span>(Intercept, <span class="fl">0.975</span>),</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_slope_lower =</span> <span class="fu">quantile</span>(Slope, <span class="fl">0.025</span>),</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_slope_upper =</span> <span class="fu">quantile</span>(Slope, <span class="fl">0.975</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>lmer_plot <span class="ot">=</span> simulated_data_lmer<span class="sc">|&gt;</span> </span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(sev, <span class="at">y =</span> yld)) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"NA"</span>)<span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span>regression_trial_m, <span class="fu">aes</span>(<span class="at">slope =</span> Slope, <span class="at">intercept =</span> Intercept), <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span><span class="do">##9ccb86</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_abline(data =summary_stats, aes(slope = mean_slope, intercept = mean_intercept),</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a> <span class="co">#             size = 1.5, fill = "black", color = "black")+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> summary_stats,<span class="fu">aes</span>(<span class="at">intercept =</span> ci_intercept_lower,<span class="at">slope =</span> ci_slope_lower) ,</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> summary_stats, <span class="fu">aes</span>(<span class="at">intercept =</span> ci_intercept_upper,<span class="at">slope =</span> ci_slope_upper), <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"grey"</span>, <span class="at">color =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>( <span class="fu">aes</span>(<span class="at">slope =</span> <span class="sc">-</span><span class="fl">49.38</span>, <span class="at">intercept =</span> <span class="fl">9691.0</span>),</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fl">9555.81</span>,<span class="at">slope =</span> <span class="sc">-</span><span class="fl">50.65</span>) ,</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> .<span class="dv">51</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fl">9826.19</span>,<span class="at">slope =</span> <span class="sc">-</span><span class="fl">48.12</span>), <span class="at">size =</span> .<span class="dv">51</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>   ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>, <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>lmer_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="joining" class="level2">
<h2 class="anchored" data-anchor-id="joining">Joining</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(trials,lmer_plot,plot_sev, plot_yld, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"(a)"</span>,<span class="st">"(b)"</span>,<span class="st">"(c)"</span>,<span class="st">"(d)"</span>), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_size =</span> <span class="dv">10</span>, <span class="at">label_x =</span> <span class="sc">-</span><span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/obs_simu_model.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>,<span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(estria2<span class="sc">$</span>mean_sev, estria2<span class="sc">$</span>mean_yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.4051456</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(simulated_data_lmer<span class="sc">$</span>sev, simulated_data_lmer<span class="sc">$</span>yld)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5508678</code></pre>
</div>
</div>
</section>
</section>
<section id="performance" class="level1">
<h1>Performance</h1>
<section id="empirical" class="level3">
<h3 class="anchored" data-anchor-id="empirical">Empirical</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>obs_lmer_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(obs_model_lmer)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>obs_lmer_observed <span class="ot">&lt;-</span> estria2<span class="sc">$</span>mean_yld</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>obs_lmer_residuals <span class="ot">&lt;-</span> obs_lmer_observed <span class="sc">-</span> obs_lmer_predicted</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>obs_lmer_RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(obs_lmer_residuals<span class="sc">^</span><span class="dv">2</span>))  </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>obs_lmer_MAE <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(obs_lmer_residuals))     </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>obs_lmer_correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(obs_lmer_observed, obs_lmer_predicted)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_normality</span>(obs_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.227).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_heteroscedasticity</span>(obs_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_autocorrelation</span>(obs_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Autocorrelated residuals detected (p = 0.004).</code></pre>
</div>
</div>
</section>
<section id="simulated" class="level3">
<h3 class="anchored" data-anchor-id="simulated">Simulated</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>simu_lmer_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(simu_model_lmer)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>simu_lmer_observed <span class="ot">&lt;-</span> simulated_data_lmer<span class="sc">$</span>yld</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>simu_lmer_residuals <span class="ot">&lt;-</span> simu_lmer_observed <span class="sc">-</span> simu_lmer_predicted</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>simu_lmer_RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(simu_lmer_residuals<span class="sc">^</span><span class="dv">2</span>))  </span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>simu_lmer_MAE <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(simu_lmer_residuals))     </span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>simu_lmer_correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(simu_lmer_observed, simu_lmer_predicted)       </span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_normality</span>(simu_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.875).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_heteroscedasticity</span>(simu_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Heteroscedasticity (non-constant error variance) detected (p &lt; .001).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_autocorrelation</span>(simu_model_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Autocorrelated residuals detected (p &lt; .001).</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<section id="simulated-1" class="level4">
<h4 class="anchored" data-anchor-id="simulated-1">Simulated</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair os resíduos e quantis teóricos</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>lmer_residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(simu_model_lmer, <span class="at">type =</span> <span class="st">"deviance"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>lmer_qq_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">theoretical =</span> <span class="fu">qqnorm</span>(lmer_residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">qqnorm</span>(lmer_residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>y</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar o QQ plot</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>lmer_qq <span class="ot">=</span> lmer_qq_data <span class="sc">%&gt;%</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theoretical, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>lmer_qq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair preditores lineares e resíduos</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>lmer_linear_predictors <span class="ot">&lt;-</span> <span class="fu">predict</span>(simu_model_lmer, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>lmer_residuals_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">linear_predictors =</span> lmer_linear_predictors,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> lmer_residuals</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar resíduos vs preditores lineares</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>lmer_predictors <span class="ot">=</span> lmer_residuals_data <span class="sc">%&gt;%</span> </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear_predictors, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.4</span>) <span class="sc">+</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Linear Predictors"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular média e desvio-padrão dos resíduos</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>mean_res <span class="ot">&lt;-</span> <span class="fu">mean</span>(lmer_residuals_data<span class="sc">$</span>residuals)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>sd_res <span class="ot">&lt;-</span> <span class="fu">sd</span>(lmer_residuals_data<span class="sc">$</span>residuals)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar o histograma e a curva acumulada normal</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>lmer_res_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmer_residuals_data, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># Ajusta para densidade</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_res, <span class="at">sd =</span> sd_res), </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span> <span class="co"># Adiciona a curva normal</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500</span>, <span class="sc">-</span><span class="dv">1250</span>, <span class="dv">0</span>, <span class="dv">1250</span>, <span class="dv">2500</span>), </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500</span>, <span class="dv">2500</span>)) <span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Deviance Residuals"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir o gráfico</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>lmer_res_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair valores observados e preditos</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>lmer_observed <span class="ot">&lt;-</span> simulated_data_lmer<span class="sc">$</span>yld</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>lmer_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(simu_model_lmer, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>lmer_prediction_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">observed =</span> lmer_observed,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted =</span> lmer_predicted</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar valores preditos vs observados</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>lmer_pd_ob <span class="ot">=</span> lmer_prediction_data <span class="sc">%&gt;%</span> </span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.4</span>) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>lmer_pd_ob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(lmer_prediction_data<span class="sc">$</span>predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12122.53</code></pre>
</div>
</div>
</section>
<section id="observed" class="level4">
<h4 class="anchored" data-anchor-id="observed">Observed</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair os resíduos e quantis teóricos</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>obs_lmer_residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(obs_model_lmer, <span class="at">type =</span> <span class="st">"deviance"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>obs_lmer_qq_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">theoretical =</span> <span class="fu">qqnorm</span>(obs_lmer_residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">qqnorm</span>(obs_lmer_residuals, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>y</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar o QQ plot</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>obs_lmer_qq <span class="ot">=</span> obs_lmer_qq_data <span class="sc">%&gt;%</span> </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>residuals <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theoretical, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Dev. Residuals"</span>) <span class="sc">+</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>obs_lmer_qq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair preditores lineares e resíduos</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>obs_lmer_linear_predictors <span class="ot">&lt;-</span> <span class="fu">predict</span>(obs_model_lmer, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>obs_lmer_residuals_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">linear_predictors =</span> obs_lmer_linear_predictors,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> obs_lmer_residuals</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar resíduos vs preditores lineares</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>obs_lmer_predictors <span class="ot">=</span> obs_lmer_residuals_data <span class="sc">%&gt;%</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>residuals <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear_predictors, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.4</span>) <span class="sc">+</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="sc">-</span><span class="dv">2000</span>,<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>), </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>, <span class="dv">3000</span>))<span class="sc">+</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Linear Predictors"</span>, <span class="at">y =</span> <span class="st">"Dev. Residuals"</span>) <span class="sc">+</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular média e desvio-padrão dos resíduos</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>mean_res <span class="ot">&lt;-</span> <span class="fu">mean</span>(obs_lmer_residuals_data<span class="sc">$</span>residuals)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>sd_res <span class="ot">&lt;-</span> <span class="fu">sd</span>(obs_lmer_residuals_data<span class="sc">$</span>residuals)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar o histograma e a curva acumulada normal</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>obs_lmer_res_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(obs_lmer_residuals_data, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># Ajusta para densidade</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_res, <span class="at">sd =</span> sd_res), </span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span> <span class="co"># Adiciona a curva normal</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500</span>, <span class="sc">-</span><span class="dv">1250</span>, <span class="dv">0</span>, <span class="dv">1250</span>, <span class="dv">2500</span>), </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500</span>, <span class="dv">2500</span>)) <span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Deviance Residuals"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir o gráfico</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>obs_lmer_res_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair valores observados e preditos</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>obs_lmer_observed <span class="ot">&lt;-</span> estria2<span class="sc">$</span>mean_yld</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>obs_lmer_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(obs_model_lmer, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>obs_lmer_prediction_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">observed =</span> obs_lmer_observed,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">predicted =</span> obs_lmer_predicted</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotar valores preditos vs observados</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>obs_lmer_pd_ob <span class="ot">=</span> obs_lmer_prediction_data <span class="sc">%&gt;%</span> </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.4</span>) <span class="sc">+</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>,<span class="dv">8000</span>,<span class="dv">10000</span>,<span class="dv">12000</span>), </span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">12000</span>))<span class="sc">+</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed"</span>, <span class="at">y =</span> <span class="st">"Predicted"</span>) <span class="sc">+</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>obs_lmer_pd_ob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-1" class="level4">
<h4 class="anchored" data-anchor-id="plotting-1">Plotting</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_grid(obs_lmer_pd_ob,lmer_pd_ob,</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#         obs_lmer_qq,lmer_qq,</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        obs_lmer_predictors,lmer_predictors,</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">#       obs_lmer_res_hist,lmer_res_hist, ncol = 2, labels = c("a"),</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      label_x = -0.01,label_y = 0.01)</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>(obs_lmer_pd_ob <span class="sc">|</span> lmer_pd_ob) <span class="sc">/</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>(obs_lmer_qq <span class="sc">|</span> lmer_qq) <span class="sc">/</span> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>(obs_lmer_predictors <span class="sc">|</span> lmer_predictors) <span class="sc">/</span> </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>(obs_lmer_res_hist <span class="sc">|</span> lmer_res_hist) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>, <span class="at">tag_prefix =</span> <span class="st">"("</span>, <span class="at">tag_suffix =</span> <span class="st">")"</span>) <span class="sc">&amp;</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/lmm_residue.png"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="power-analysis-of-model-by-simulation" class="level1">
<h1>Power analysis of model by simulation</h1>
<section id="severity-1" class="level3">
<h3 class="anchored" data-anchor-id="severity-1">Severity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simr)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste do modelo original</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>sev_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(mean_yld <span class="sc">~</span> mean_sev <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> trial), <span class="at">data =</span> estria2)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um modelo extendido para simulação</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>ext_sev_lmer <span class="ot">&lt;-</span> <span class="fu">extend</span>(sev_lmer, <span class="at">along =</span> <span class="st">"mean_sev"</span>, <span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Rodar várias simulações do powerCurve e armazenar os resultados</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">50</span>  <span class="co"># Número de simulações individuais</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>power_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  power_results[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">summary</span>(<span class="fu">powerCurve</span>(ext_sev_lmer, </span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">along =</span> <span class="st">"mean_sev"</span>, </span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">nsim =</span> <span class="dv">100</span>, </span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)))</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>power_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(power_results, <span class="at">.id =</span> <span class="st">"simulation"</span>)</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="co">#write_xlsx(power_df, "data/power_df.xlsx")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>power_df <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="st">"data/power_df.xlsx"</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>power_df2 <span class="ot">&lt;-</span> power_df <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nlevels) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> <span class="fu">mean</span>(lower, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper =</span> <span class="fu">mean</span>(upper, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>power_df <span class="sc">%&gt;%</span> </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mean <span class="sc">&gt;=</span> <span class="fl">0.80</span> <span class="sc">&amp;</span> mean <span class="sc">&lt;=</span><span class="fl">0.85</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["simulation"],"name":[1],"type":["chr"],"align":["left"]},{"label":["nrow"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["nlevels"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["successes"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["trials"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["lower"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["upper"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"84","3":"26","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"2","2":"81","3":"25","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"3","2":"77","3":"24","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"4","2":"81","3":"25","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"5","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"7","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"8","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"8","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"10","2":"77","3":"24","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"10","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"11","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"12","2":"84","3":"26","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"13","2":"84","3":"26","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"14","2":"81","3":"25","4":"80","5":"100","6":"0.80","7":"0.7081573","8":"0.8733444"},{"1":"14","2":"84","3":"26","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"15","2":"77","3":"24","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"17","2":"81","3":"25","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"17","2":"84","3":"26","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"18","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"19","2":"75","3":"23","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"19","2":"77","3":"24","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"20","2":"81","3":"25","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"20","2":"84","3":"26","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"23","2":"84","3":"26","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"24","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"25","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"26","2":"75","3":"23","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"27","2":"77","3":"24","4":"80","5":"100","6":"0.80","7":"0.7081573","8":"0.8733444"},{"1":"28","2":"81","3":"25","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"29","2":"75","3":"23","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"29","2":"77","3":"24","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"30","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"31","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"32","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"32","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"33","2":"77","3":"24","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"35","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"35","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"36","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"37","2":"81","3":"25","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"38","2":"84","3":"26","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"39","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"41","2":"81","3":"25","4":"80","5":"100","6":"0.80","7":"0.7081573","8":"0.8733444"},{"1":"41","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"42","2":"74","3":"22","4":"80","5":"100","6":"0.80","7":"0.7081573","8":"0.8733444"},{"1":"42","2":"75","3":"23","4":"81","5":"100","6":"0.81","7":"0.7193020","8":"0.8815568"},{"1":"42","2":"77","3":"24","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"43","2":"81","3":"25","4":"82","5":"100","6":"0.82","7":"0.7305229","8":"0.8896888"},{"1":"43","2":"84","3":"26","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"44","2":"81","3":"25","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"44","2":"84","3":"26","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"45","2":"84","3":"26","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"46","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"47","2":"81","3":"25","4":"85","5":"100","6":"0.85","7":"0.7646925","8":"0.9135456"},{"1":"48","2":"81","3":"25","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"49","2":"81","3":"25","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"},{"1":"50","2":"81","3":"25","4":"84","5":"100","6":"0.84","7":"0.7532124","8":"0.9056897"},{"1":"50","2":"84","3":"26","4":"83","5":"100","6":"0.83","7":"0.7418246","8":"0.8977351"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="plotting-2" class="level4">
<h4 class="anchored" data-anchor-id="plotting-2">Plotting</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linhas cinzas para cada simulação individual</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> power_df, <span class="fu">aes</span>(<span class="at">x =</span> nlevels, <span class="at">y =</span> mean <span class="sc">*</span> <span class="dv">100</span>, <span class="at">group =</span> simulation), </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linha da média (laranja)</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> power_df2, <span class="fu">aes</span>(<span class="at">x =</span> nlevels, <span class="at">y =</span> mean <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linhas superior e inferior (preto, tracejado)</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> power_df2, <span class="fu">aes</span>(<span class="at">x =</span> nlevels, <span class="at">y =</span> upper <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> power_df2, <span class="fu">aes</span>(<span class="at">x =</span> nlevels, <span class="at">y =</span> lower <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="dv">40</span>,<span class="dv">45</span>,<span class="dv">50</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))<span class="sc">+</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">80</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>)<span class="sc">+</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>)<span class="sc">+</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="sc">+</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>,</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Power (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/power_model.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>,<span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="damage" class="level1">
<h1>Damage</h1>
<section id="economic-losses" class="level2">
<h2 class="anchored" data-anchor-id="economic-losses">Economic losses</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>sev  <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sev =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>yield <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yld =</span> <span class="fu">seq</span>(<span class="dv">4000</span>,<span class="dv">12000</span>,<span class="at">by =</span> <span class="dv">500</span>))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>price <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">price =</span> <span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">300</span>, <span class="at">by =</span> <span class="dv">100</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sev =</span> sev<span class="sc">$</span>sev, <span class="at">yld =</span> yield<span class="sc">$</span>yld, <span class="at">price =</span> price<span class="sc">$</span>price)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>ylmer_simu_min <span class="ot">=</span> combined_data <span class="sc">%&gt;%</span> </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loss =</span>((((((<span class="fl">49.3</span><span class="sc">/</span><span class="fl">9691.0</span>)<span class="sc">*</span>sev)<span class="sc">*</span><span class="dv">100</span>)<span class="sc">*</span>yld)<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">*</span>price)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"100"</span> <span class="ot">=</span> <span class="st">"100 USD/ton"</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"200"</span> <span class="ot">=</span> <span class="st">"200 USD/ton"</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"300"</span> <span class="ot">=</span> <span class="st">"300 USD/ton"</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a> heat_loss <span class="ot">=</span>ylmer_simu_min <span class="sc">%&gt;%</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(price <span class="sc">==</span> <span class="st">"200"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sev,yld, <span class="at">fill =</span> loss)) <span class="sc">+</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">4000</span>, <span class="dv">12000</span>, <span class="at">by =</span> <span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_b</span>(<span class="at">option =</span> <span class="st">"E"</span>, </span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">barwidth =</span> <span class="fl">0.3</span>, <span class="at">barheight =</span> <span class="dv">15</span>), </span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2000</span>, <span class="at">by =</span> <span class="dv">300</span>))<span class="sc">+</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">as.integer</span>(loss)),</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>   <span class="co">#facet_wrap(~price, labeller = as_labeller(custom_labels))+</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal_grid</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Attainable yield (kg/ha)"</span>,</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Disease severity (%)"</span>,</span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"L (USD/ha)"</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">14</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axis.text.y = element_text(hjust = -3),</span></span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">3</span>),</span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fl">0.5</span>,</span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>hist_loss <span class="ot">=</span> ylmer_simu_min <span class="sc">|&gt;</span></span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">==</span> <span class="st">"200"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(loss))<span class="sc">+</span></span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill=</span> <span class="st">"#1c1c3c"</span>, <span class="at">bins =</span> <span class="dv">15</span>)<span class="sc">+</span></span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>price)<span class="sc">+</span></span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2100</span>, <span class="at">by =</span> <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Economic losses (USD/ha)"</span>)<span class="sc">+</span></span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fl">0.5</span>,</span>
<span id="cb108-62"><a href="#cb108-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-63"><a href="#cb108-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>() </span>
<span id="cb108-64"><a href="#cb108-64" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-65"><a href="#cb108-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-66"><a href="#cb108-66" aria-hidden="true" tabindex="-1"></a>loss_200 <span class="ot">=</span> ylmer_simu_min <span class="sc">|&gt;</span></span>
<span id="cb108-67"><a href="#cb108-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">==</span> <span class="st">"200"</span>) </span>
<span id="cb108-68"><a href="#cb108-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-69"><a href="#cb108-69" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(loss_200<span class="sc">$</span>loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 447.6731</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>hist_loss <span class="ot">=</span> ylmer_simu_min <span class="sc">%&gt;%</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">==</span> <span class="st">"200"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> loss)) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill =</span> <span class="st">"#ffc425"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fl">447.6731</span>), <span class="at">color =</span> <span class="st">"#1c1c3c"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>() <span class="sc">+</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>   <span class="co">#scale_x_continuous(breaks = seq(0,2100, by = 100)) +</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">150</span>,<span class="dv">250</span>,<span class="dv">350</span>,<span class="dv">450</span>,<span class="dv">550</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">650</span>,<span class="dv">750</span>,<span class="dv">850</span>,<span class="dv">950</span>,<span class="dv">1050</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">1150</span>,<span class="dv">1250</span>,<span class="dv">1350</span>,<span class="dv">1450</span>,<span class="dv">1550</span>,<span class="dv">1650</span>,<span class="dv">1750</span>,<span class="dv">1850</span>,<span class="dv">1950</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">2150</span>))<span class="sc">+</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Economic losses (USD/ha)"</span>)<span class="sc">+</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>() </span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Below 25%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>sev_loss_b25  <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sev =</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">25</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>combined_data_b25 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sev =</span> sev_loss_b25<span class="sc">$</span>sev, <span class="at">yld =</span> yield<span class="sc">$</span>yld)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>loss_25 <span class="ot">=</span> ((((((<span class="fl">49.3</span><span class="sc">/</span><span class="fl">9691.0</span>)<span class="sc">*</span><span class="dv">25</span>)<span class="sc">*</span>combined_data_b25<span class="sc">$</span>sev)<span class="sc">*</span>combined_data_b25<span class="sc">$</span>yld)<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">*</span><span class="dv">200</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30.52317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.087194</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.30791</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Above 25%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>sev_loss_a25  <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">sev =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>combined_data_a25 <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sev =</span> sev_loss_a25<span class="sc">$</span>sev, <span class="at">yld =</span> yield<span class="sc">$</span>yld)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>loss_25 <span class="ot">=</span> ((((((<span class="fl">49.3</span><span class="sc">/</span><span class="fl">9691.0</span>)<span class="sc">*</span>combined_data_a25<span class="sc">$</span>sev)<span class="sc">*</span>combined_data_a25<span class="sc">$</span>sev)<span class="sc">*</span>combined_data_a25<span class="sc">$</span>yld)<span class="sc">/</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">1000</span>)<span class="sc">*</span><span class="dv">200</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 361.1908</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.43597</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(loss_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1220.927</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>(hist_loss<span class="sc">+</span>heat_loss) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>, <span class="at">tag_prefix =</span> <span class="st">"("</span>, <span class="at">tag_suffix =</span> <span class="st">")"</span>)<span class="sc">&amp;</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggsave</span>(<span class="st">"fig/loss.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>,<span class="at">height =</span><span class="dv">8</span>, <span class="at">width =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="relative-yield" class="level2">
<h2 class="anchored" data-anchor-id="relative-yield">Relative yield</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>lmer_slope<span class="ot">=</span> lmer_stats <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Slope"</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>Fx <span class="ot">=</span><span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>lmer_slope<span class="sc">$</span>estimate))<span class="sc">$</span>y</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>lmer_slope<span class="sc">$</span>estimate))<span class="sc">$</span>x</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>slope_reg <span class="ot">=</span> <span class="fu">nlsLM</span>(Fx <span class="sc">~</span> <span class="fu">pgamma</span>(x, shape, rate,<span class="at">log =</span> <span class="cn">FALSE</span>) ,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">c</span>(<span class="at">shape =</span> <span class="fl">2.5</span>, <span class="at">rate =</span> <span class="fl">0.13</span>),</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">nls.lm.control</span>(<span class="at">maxiter =</span> <span class="dv">1024</span>))</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slope_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Fx ~ pgamma(x, shape, rate, log = FALSE)

Parameters:
      Estimate Std. Error t value Pr(&gt;|t|)    
shape 29.25149    0.62746   46.62   &lt;2e-16 ***
rate   0.58169    0.01255   46.37   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02492 on 198 degrees of freedom

Number of iterations to convergence: 12 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>shape_res <span class="ot">=</span> <span class="fu">summary</span>(slope_reg)<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>rate_res <span class="ot">=</span> <span class="fu">summary</span>(slope_reg)<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(Fx, <span class="fu">pgamma</span>(x, shape_res, rate_res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  Fx and pgamma(x, shape_res, rate_res)
D = 0.08, p-value = 0.5441
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>slope_plot <span class="ot">=</span> lmer_slope <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># Ajusta para densidade</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) <span class="fu">dgamma</span>(<span class="sc">-</span>x, shape_res, rate_res), <span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>)<span class="sc">+</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~approach)+</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Slope (kg/p.p)"</span>,</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>lmer_intercept<span class="ot">=</span> lmer_stats <span class="sc">%&gt;%</span> </span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">==</span> <span class="st">"Intercept"</span>)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(lmer_slope<span class="sc">$</span>estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  lmer_slope$estimate
W = 0.98551, p-value = 0.03812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>mean_intercept <span class="ot">=</span> <span class="fu">mean</span>(lmer_intercept<span class="sc">$</span>estimate)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>sd_intercept <span class="ot">=</span> <span class="fu">sd</span>(lmer_intercept<span class="sc">$</span>estimate)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>intercept_plot <span class="ot">&lt;-</span> lmer_intercept <span class="sc">%&gt;%</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span> <span class="co"># Ajusta para densidade</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_intercept, <span class="at">sd =</span> sd_intercept), </span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>)<span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~approach)+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Intercept (kg/ha)"</span>,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>u_j <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> random_effect_sd)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mean_uj = mean(u_j)</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sev =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>), <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>yield <span class="ot">=</span> <span class="fl">9691.0</span> <span class="sc">-</span> <span class="fl">49.38</span><span class="sc">*</span>df<span class="sc">$</span>sev <span class="sc">-</span> <span class="fu">rep</span>(u_j, <span class="at">each =</span> <span class="dv">101</span>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>relative <span class="ot">&lt;-</span> df<span class="sc">$</span>yield <span class="sc">*</span><span class="dv">100</span> <span class="sc">/</span> <span class="fl">9691.0</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sev) <span class="sc">%&gt;%</span> </span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(relative),</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">up_95 =</span> <span class="fu">quantile</span>(relative, <span class="fl">0.975</span>),</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">low_95 =</span> <span class="fu">quantile</span>(relative, <span class="fl">0.025</span>))</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>relative_plot <span class="ot">=</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> sev, <span class="at">y =</span> relative, <span class="at">group =</span> rep), </span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>  <span class="co"># Linhas cinzas para cada simulação</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> sev, <span class="at">y =</span> mean), </span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">1.4</span>) <span class="sc">+</span>  <span class="co"># Linha média</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> sev, <span class="at">y =</span> up_95), </span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># IC superior</span></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df2, <span class="fu">aes</span>(<span class="at">x =</span> sev, <span class="at">y =</span> low_95), </span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># IC inferior</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>, <span class="dv">40</span>,<span class="dv">50</span>, <span class="dv">60</span>,</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>                                <span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>), </span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>),</span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>, <span class="dv">100</span>),</span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Disease severity (%)"</span>, <span class="at">y =</span> <span class="st">"Relative yield (%) "</span>)<span class="sc">+</span></span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">87</span>,</span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>), <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),   </span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot_grid(slope_plot / intercept_plot | relative_plot, ncol = 1,</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a> <span class="co">#         label_x = -0.02, label_size = 12)</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>(slope_plot <span class="sc">/</span> intercept_plot <span class="sc">|</span>relative_plot) <span class="sc">+</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>, <span class="at">tag_prefix =</span> <span class="st">"("</span>, <span class="at">tag_suffix =</span> <span class="st">")"</span>)<span class="sc">&amp;</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/relative_parameters.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">dpi =</span> <span class="dv">600</span>,</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="break-even-probability" class="level1">
<h1>Break-even probability</h1>
<section id="framework-simulation" class="level2">
<h2 class="anchored" data-anchor-id="framework-simulation">Framework simulation</h2>
<section id="norta-function" class="level3">
<h3 class="anchored" data-anchor-id="norta-function">NORTA function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>gera.norm.bid.geral<span class="ot">&lt;-</span><span class="cf">function</span>(tamanho.amostra,correlacao,m1,m2,sigma1,sigma2)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  ro<span class="ot">&lt;-</span>correlacao</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span>tamanho.amostra</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  {x[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,sigma1)</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  x[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2<span class="sc">+</span>ro<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x[i,<span class="dv">1</span>]<span class="sc">-</span>m1),sigma2<span class="sc">*</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>ro<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells 2949079 157.5    4708747 251.5  4708747 251.5
Vcells 5853168  44.7   64697311 493.7 80871135 617.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>estria2 <span class="sc">%&gt;%</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mean_sev))<span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="severity-2" class="level3">
<h3 class="anchored" data-anchor-id="severity-2">Severity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>sev <span class="ot">=</span> simulated_data_lmer<span class="sc">$</span>sev</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co">#sev = estria2$mean_sev</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>Fx_sev <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(sev))<span class="sc">$</span>y</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>x_sev <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(sev))<span class="sc">$</span>x<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">nlsLM</span>(Fx_sev <span class="sc">~</span> <span class="fu">pbeta</span>(x_sev, shape1, shape2, <span class="at">log =</span> <span class="cn">FALSE</span>) ,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">c</span>(<span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>),</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">nls.lm.control</span>(<span class="at">maxiter =</span> <span class="dv">100000</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Fx_sev ~ pbeta(x_sev, shape1, shape2, log = FALSE)

Parameters:
        Estimate Std. Error t value Pr(&gt;|t|)    
shape1 1.2041125  0.0005694    2115   &lt;2e-16 ***
shape2 3.6414300  0.0020387    1786   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.004923 on 9998 degrees of freedom

Number of iterations to convergence: 7 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(Fx_sev,<span class="fu">pbeta</span>(x_sev,<span class="fl">1.2041125</span>,<span class="fl">3.6414300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  Fx_sev and pbeta(x_sev, 1.2041125, 3.64143)
D = 0.0111, p-value = 0.5689
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x_sev,Fx_sev)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbeta</span>(x, <span class="fl">1.2041125</span>,<span class="fl">3.6414300</span>),<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="intercept" class="level3">
<h3 class="anchored" data-anchor-id="intercept">Intercept</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>intercept_bls <span class="ot">=</span> regression_trial_m</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>intercept_bls[,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>mean_intercept <span class="ot">=</span> <span class="fu">mean</span>(intercept_bls<span class="sc">$</span>Intercept)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>sd_intercept <span class="ot">=</span> <span class="fu">sd</span>(intercept_bls<span class="sc">$</span>Intercept)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(intercept_bls<span class="sc">$</span>Intercept))</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x, mean_intercept,sd_intercept), <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>Fx_res_b0 <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(intercept_bls<span class="sc">$</span>Intercept))<span class="sc">$</span>y</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>x_res_b0<span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(intercept_bls<span class="sc">$</span>Intercept))<span class="sc">$</span>x</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(Fx_res_b0, <span class="fu">pnorm</span>(x_res_b0, <span class="fu">mean</span>(intercept_bls<span class="sc">$</span>Intercept), <span class="fu">sd</span>(intercept_bls<span class="sc">$</span>Intercept)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  Fx_res_b0 and pnorm(x_res_b0, mean(intercept_bls$Intercept), sd(intercept_bls$Intercept))
D = 0.045, p-value = 0.9874
alternative hypothesis: two-sided</code></pre>
</div>
</div>
</section>
<section id="slope" class="level3">
<h3 class="anchored" data-anchor-id="slope">Slope</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>slope_bls <span class="ot">=</span> regression_trial_m</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>slope_bls[,<span class="dv">2</span>] <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>mean_slope <span class="ot">=</span> <span class="fu">mean</span>(slope_bls<span class="sc">$</span>Slope)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>sd_slope <span class="ot">=</span> <span class="fu">sd</span>(slope_bls<span class="sc">$</span>Slope)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(slope_bls<span class="sc">$</span>Slope))</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x, mean_slope, sd_slope), <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>Fx <span class="ot">=</span><span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>slope_bls<span class="sc">$</span>Slope))<span class="sc">$</span>y</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>slope_bls<span class="sc">$</span>Slope))<span class="sc">$</span>x</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>slope_reg <span class="ot">=</span> <span class="fu">nlsLM</span>(Fx <span class="sc">~</span> <span class="fu">pgamma</span>(x, shape, rate,<span class="at">log =</span> <span class="cn">FALSE</span>) ,</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">start =</span> <span class="fu">c</span>(<span class="at">shape =</span> <span class="fl">2.5</span>, <span class="at">rate =</span> <span class="fl">0.13</span>),</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">nls.lm.control</span>(<span class="at">maxiter =</span> <span class="dv">1024</span>))</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slope_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: Fx ~ pgamma(x, shape, rate, log = FALSE)

Parameters:
      Estimate Std. Error t value Pr(&gt;|t|)    
shape 29.25149    0.62746   46.62   &lt;2e-16 ***
rate   0.58169    0.01255   46.37   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02492 on 198 degrees of freedom

Number of iterations to convergence: 12 
Achieved convergence tolerance: 1.49e-08</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>shape <span class="ot">=</span> <span class="fu">summary</span>(slope_reg)<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">=</span> <span class="fu">summary</span>(slope_reg)<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>Fx <span class="ot">=</span><span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>slope_bls<span class="sc">$</span>Slope))<span class="sc">$</span>y</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(<span class="sc">-</span>slope_bls<span class="sc">$</span>Slope))<span class="sc">$</span>x</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(Fx, <span class="fu">pgamma</span>(x, shape, rate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic two-sample Kolmogorov-Smirnov test

data:  Fx and pgamma(x, shape, rate)
D = 0.08, p-value = 0.5441
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(regression_trial_m<span class="sc">$</span>Slope,regression_trial_m<span class="sc">$</span>Intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1547164</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>j_res<span class="ot">&lt;-</span><span class="fu">gera.norm.bid.geral</span>(<span class="dv">10000</span>,<span class="fl">0.15</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(j_res[,<span class="dv">1</span>],j_res[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="corn-price" class="level3">
<h3 class="anchored" data-anchor-id="corn-price">Corn price</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>corn <span class="ot">=</span> <span class="fu">gsheet2tbl</span>(<span class="st">"https://docs.google.com/spreadsheets/d/1LcLVKb6bW7tVaiu6reLsT8sjFR1hwUcembZ7uxAoBP8/edit?usp=sharing"</span>) </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>corn <span class="ot">=</span> corn <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="dv">2019</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>bls_price <span class="ot">=</span> corn <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(year &lt;= 2019) %&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price =</span> (price<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>bls_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["data"],"name":[1],"type":["chr"],"align":["left"]},{"label":["price"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["national"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["year"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["state"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"12/2019","2":"0.15208333","3":"37.34","4":"2019","5":"PR"},{"1":"11/2019","2":"0.14058333","3":"34.75","4":"2019","5":"PR"},{"1":"10/2019","2":"0.13100000","3":"32.71","4":"2019","5":"PR"},{"1":"9/2019","2":"0.11858333","3":"30.87","4":"2019","5":"PR"},{"1":"8/2019","2":"0.12141667","3":"30.82","4":"2019","5":"PR"},{"1":"7/2019","2":"0.12558333","3":"31.04","4":"2019","5":"PR"},{"1":"6/2019","2":"0.12387500","3":"30.43","4":"2019","5":"PR"},{"1":"5/2019","2":"0.11179167","3":"29.42","4":"2019","5":"PR"},{"1":"4/2019","2":"0.11962500","3":"31.14","4":"2019","5":"PR"},{"1":"3/2019","2":"0.13191667","3":"32.12","4":"2019","5":"PR"},{"1":"2/2019","2":"0.12983333","3":"31.59","4":"2019","5":"PR"},{"1":"1/2019","2":"0.12433333","3":"31.11","4":"2019","5":"PR"},{"1":"12/2018","2":"0.12066667","3":"31.07","4":"2018","5":"PR"},{"1":"11/2018","2":"0.11795833","3":"31.06","4":"2018","5":"PR"},{"1":"10/2018","2":"0.12808333","3":"32.94","4":"2018","5":"PR"},{"1":"9/2018","2":"0.13858333","3":"34.72","4":"2018","5":"PR"},{"1":"8/2018","2":"0.13575000","3":"33.19","4":"2018","5":"PR"},{"1":"7/2018","2":"0.12941667","3":"31.57","4":"2018","5":"PR"},{"1":"6/2018","2":"0.14054167","3":"33.40","4":"2018","5":"PR"},{"1":"5/2018","2":"0.13704167","3":"33.07","4":"2018","5":"PR"},{"1":"4/2018","2":"0.13304167","3":"32.27","4":"2018","5":"PR"},{"1":"3/2018","2":"0.12037500","3":"29.29","4":"2018","5":"PR"},{"1":"2/2018","2":"0.09941667","3":"25.93","4":"2018","5":"PR"},{"1":"1/2018","2":"0.09908333","3":"25.62","4":"2018","5":"PR"},{"1":"12/2017","2":"0.09795833","3":"25.25","4":"2017","5":"PR"},{"1":"11/2017","2":"0.09400000","3":"24.74","4":"2017","5":"PR"},{"1":"10/2017","2":"0.08920833","3":"23.66","4":"2017","5":"PR"},{"1":"9/2017","2":"0.08150000","3":"21.78","4":"2017","5":"PR"},{"1":"8/2017","2":"0.07679167","3":"20.40","4":"2017","5":"PR"},{"1":"7/2017","2":"0.08333333","3":"20.69","4":"2017","5":"PR"},{"1":"6/2017","2":"0.08720833","3":"21.38","4":"2017","5":"PR"},{"1":"5/2017","2":"0.08925000","3":"22.18","4":"2017","5":"PR"},{"1":"4/2017","2":"0.09100000","3":"23.15","4":"2017","5":"PR"},{"1":"3/2017","2":"0.10195833","3":"26.22","4":"2017","5":"PR"},{"1":"2/2017","2":"0.11037500","3":"28.63","4":"2017","5":"PR"},{"1":"1/2017","2":"0.11916667","3":"31.29","4":"2017","5":"PR"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07679167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1153426</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1153426</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0198195</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>bls_price <span class="sc">%&gt;%</span> </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(price))<span class="sc">+</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">bins =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a> ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Soybean prince"</span>,</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.025</span>))<span class="sc">+</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>((bls_price<span class="sc">$</span>price), <span class="at">prob =</span> T)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="fu">mean</span>(bls_price<span class="sc">$</span>price), <span class="fu">sd</span>(bls_price<span class="sc">$</span>price)),<span class="fl">0.15</span>,<span class="fl">0.35</span>, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(bls_price<span class="sc">$</span>price))</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnorm</span>(x, <span class="fu">mean</span>(bls_price<span class="sc">$</span>price), <span class="fu">sd</span>(bls_price<span class="sc">$</span>price)),<span class="fl">0.2</span>,<span class="fl">0.35</span>, <span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1153426</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.12</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(bls_price<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  bls_price$price
W = 0.94849, p-value = 0.0937</code></pre>
</div>
</div>
<section id="kolmogorov-smirnov-test" class="level4">
<h4 class="anchored" data-anchor-id="kolmogorov-smirnov-test">Kolmogorov-Smirnov Test</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>Fx <span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(bls_price<span class="sc">$</span>price))<span class="sc">$</span>y</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span> <span class="fu">environment</span>(<span class="fu">ecdf</span>(bls_price<span class="sc">$</span>price))<span class="sc">$</span>x</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(Fx, <span class="fu">pnorm</span>(x, <span class="fu">mean</span>(bls_price<span class="sc">$</span>price), <span class="fu">sd</span>(bls_price<span class="sc">$</span>price)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact two-sample Kolmogorov-Smirnov test

data:  Fx and pnorm(x, mean(bls_price$price), sd(bls_price$price))
D = 0.13889, p-value = 0.8849
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Fx, <span class="fu">pnorm</span>(x, <span class="fu">mean</span>(bls_price<span class="sc">$</span>price), <span class="fu">sd</span>(bls_price<span class="sc">$</span>price)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vizualization" class="level4">
<h4 class="anchored" data-anchor-id="vizualization">Vizualization</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>price_plot <span class="ot">=</span> bls_price <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(price))<span class="sc">+</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>)<span class="sc">+</span> <span class="co">#"#1C8C20"</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">#stat_function(fun=function(x) dnorm(x, mean(sbr_price$price), sd(sbr_price$price)), color= "black", size = 1.2)+</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Soybean price (USD/kg)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.025</span>))<span class="sc">+</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>price_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"fig/soybean_price.png"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">width =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">40000</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.05</span>)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>fun_price <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">260</span>, <span class="at">by=</span><span class="dv">15</span>)</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>n_aplication <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>operational_cost <span class="ot">=</span> <span class="dv">10</span>  </span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>comb_matrix <span class="ot">=</span> <span class="fu">as.matrix</span>(data.table<span class="sc">::</span><span class="fu">CJ</span>(lambda,fun_price))</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comb_matrix) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lambda"</span>,<span class="st">"fun_price"</span>)</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>comb_matrix <span class="ot">=</span> <span class="fu">cbind</span>(comb_matrix,operational_cost, n_aplication)</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> comb_matrix[,<span class="st">"n_aplication"</span>]<span class="sc">*</span>(comb_matrix[,<span class="st">"operational_cost"</span>]<span class="sc">+</span>comb_matrix[,<span class="st">"fun_price"</span>] )</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>comb_matrix <span class="ot">=</span> <span class="fu">cbind</span>(comb_matrix,C)</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(comb_matrix[,<span class="dv">1</span>])<span class="sc">*</span>n</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>big_one <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">12</span>, <span class="at">nrow =</span>N)</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rep</span>(comb_matrix[,<span class="dv">1</span>],n)</span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rep</span>(comb_matrix[,<span class="dv">2</span>],n)</span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">rep</span>(comb_matrix[,<span class="dv">3</span>],n)</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">rep</span>(comb_matrix[,<span class="dv">4</span>],n)</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">rep</span>(comb_matrix[,<span class="dv">5</span>],n)</span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>sn <span class="ot">=</span> <span class="fu">rbeta</span>(N, <span class="fl">1.2041125</span>,<span class="fl">3.6414300</span>)</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>sf <span class="ot">=</span> sn<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>big_one[,<span class="dv">1</span>])</span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a><span class="co"># simulating the coeficientes </span></span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a>normal_correlated<span class="ot">&lt;-</span><span class="fu">gera.norm.bid.geral</span>(N,<span class="fl">0.15</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a>b0_n <span class="ot">=</span> <span class="fu">pnorm</span>(normal_correlated[,<span class="dv">2</span>])</span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true" tabindex="-1"></a>b1_n <span class="ot">=</span> <span class="fu">pnorm</span>(normal_correlated[,<span class="dv">1</span>])</span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="fu">qnorm</span>(b0_n, mean_intercept,sd_intercept)</span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="sc">-</span><span class="fu">qgamma</span>(b1_n, shape, rate,)</span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(b0_n,b1_n,normal_correlated)</span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-39"><a href="#cb180-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-40"><a href="#cb180-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the alha coeficient</span></span>
<span id="cb180-41"><a href="#cb180-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-42"><a href="#cb180-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-43"><a href="#cb180-43" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">=</span> (b1<span class="sc">/</span>b0)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb180-44"><a href="#cb180-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-45"><a href="#cb180-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating yield gain</span></span>
<span id="cb180-46"><a href="#cb180-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-47"><a href="#cb180-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Moderate Resistant (MR)</span></span>
<span id="cb180-48"><a href="#cb180-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-49"><a href="#cb180-49" aria-hidden="true" tabindex="-1"></a>yn  <span class="ot">=</span> b0 <span class="sc">-</span> (<span class="sc">-</span>alfa<span class="sc">*</span>b0<span class="sc">*</span>sn)</span>
<span id="cb180-50"><a href="#cb180-50" aria-hidden="true" tabindex="-1"></a>yf  <span class="ot">=</span> b0 <span class="sc">-</span> (<span class="sc">-</span>alfa<span class="sc">*</span>b0<span class="sc">*</span>sf)</span>
<span id="cb180-51"><a href="#cb180-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-52"><a href="#cb180-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-53"><a href="#cb180-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulating soybean price</span></span>
<span id="cb180-54"><a href="#cb180-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-55"><a href="#cb180-55" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb180-56"><a href="#cb180-56" aria-hidden="true" tabindex="-1"></a>soy_price <span class="ot">=</span> <span class="fu">rnorm</span>(N, <span class="fu">mean</span>(bls_price<span class="sc">$</span>price),<span class="fu">sd</span>(bls_price<span class="sc">$</span>price))</span>
<span id="cb180-57"><a href="#cb180-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-58"><a href="#cb180-58" aria-hidden="true" tabindex="-1"></a><span class="co">#income = yield_gain*soy_price # calculating the income</span></span>
<span id="cb180-59"><a href="#cb180-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-60"><a href="#cb180-60" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">6</span>] <span class="ot">=</span> yn</span>
<span id="cb180-61"><a href="#cb180-61" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">7</span>] <span class="ot">=</span> yf</span>
<span id="cb180-62"><a href="#cb180-62" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">8</span>] <span class="ot">=</span> b1</span>
<span id="cb180-63"><a href="#cb180-63" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">9</span>] <span class="ot">=</span> b0</span>
<span id="cb180-64"><a href="#cb180-64" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">10</span>] <span class="ot">=</span> sn</span>
<span id="cb180-65"><a href="#cb180-65" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">11</span>] <span class="ot">=</span> sf</span>
<span id="cb180-66"><a href="#cb180-66" aria-hidden="true" tabindex="-1"></a>big_one[,<span class="dv">12</span>] <span class="ot">=</span> soy_price</span>
<span id="cb180-67"><a href="#cb180-67" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(big_one)  <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lambda"</span>,<span class="st">"fun_price"</span>,<span class="st">"operational_cost"</span>,<span class="st">"n_aplication"</span>,<span class="st">"C"</span>,<span class="st">"yn"</span>,<span class="st">"yf"</span>,</span>
<span id="cb180-68"><a href="#cb180-68" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"b1"</span>,<span class="st">"b0"</span>,<span class="st">"sn"</span>,<span class="st">"sf"</span>,<span class="st">"soy_price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>big_one_df <span class="ot">=</span> <span class="fu">as.data.frame</span>(big_one) <span class="sc">%&gt;%</span> </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(b0<span class="sc">&gt;=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yn<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(alfa <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">&amp;</span> alfa <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield_gain =</span> yf<span class="sc">-</span>yn,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">yield_gain_perc =</span> ((yf<span class="sc">/</span>yn)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">income =</span> yield_gain<span class="sc">*</span>soy_price,<span class="co">#0.2</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CP =</span> C<span class="sc">/</span>soy_price,<span class="co">#0.2</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">profit =</span> (income<span class="sc">&gt;=</span>C)<span class="sc">*</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">180</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(lambda <span class="sc">&gt;=</span> <span class="fl">0.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(lambda <span class="sc">&lt;=</span> <span class="fl">0.8</span>)</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_csv(big_one_df,"data/big_one_df.csv")</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>big_one_df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/big_one_df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>sn <span class="ot">=</span> big_one_df <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sn))<span class="sc">+</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha=</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>,<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"BLS severity (%)"</span>)<span class="sc">+</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells  2957877 158.0    4708747 251.5  4708747 251.5
Vcells 85476209 652.2  125675078 958.9 85646906 653.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>b0_graphic <span class="ot">=</span> big_one_df <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(b0))<span class="sc">+</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha=</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">#scale_x_continuous(breaks = c(0,1000,2000,3000,4000,5000,6000,7000), limits = c(0, 7000))+</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Intercept (kg/ha)"</span>)<span class="sc">+</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells  2958594 158.1    4708747 251.5  4708747 251.5
Vcells 85478145 652.2  125675078 958.9 85646906 653.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>b1_graphic <span class="ot">=</span> big_one_df <span class="sc">%&gt;%</span> </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(b1))<span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha=</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_continuous(breaks = c(-100,-90,-80,-70,-60,-50,-40,-30,-20,-10,0), limits = c(-100,0))+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Slope (kg/p.p.)"</span>)<span class="sc">+</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger  (Mb) max used  (Mb)
Ncells  2959325 158.1    4708747 251.5  4708747 251.5
Vcells 85480112 652.2  125675078 958.9 85646906 653.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>b1_graphic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>alpha_graphic <span class="ot">=</span> big_one_df <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">180</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&gt;=</span> <span class="fl">0.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&lt;=</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&gt;=</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(alfa))<span class="sc">+</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">bins =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_continuous(breaks = c(-2.0,-1.75,-1.50,-1.25,-1.00,-0.75,-0.50,-0.25,0.0), limits = c(-2.0,0.0))+</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Yield loss (%/p.p.)"</span>)<span class="sc">+</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>alpha_graphic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#alpha_res_graphic,alpha_m_sus_graphic,alpha_sus_graphic,</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(sn_res_graphic,b0_res_graphic,b1_res_graphic, <span class="at">ncol =</span> <span class="dv">3</span>,  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span>),<span class="at">label_x =</span> <span class="sc">-</span><span class="fl">0.03</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/simulated_variables.png"</span>, <span class="at">dpi =</span> <span class="dv">1000</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>heat <span class="ot">&lt;-</span> big_one_df <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">180</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&gt;=</span> <span class="fl">0.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&lt;=</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lambda, C) <span class="sc">%&gt;%</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">sumn =</span> <span class="fu">sum</span>(profit), <span class="at">prob =</span> sumn <span class="sc">/</span> n) </span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells  2959523 158.1    4708747  251.5   4708747  251.5
Vcells 85481175 652.2  261029279 1991.5 261024076 1991.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>heat_graphic <span class="ot">=</span> heat <span class="sc">%&gt;%</span> </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(lambda <span class="sc">*</span> <span class="dv">100</span>), <span class="fu">as.factor</span>(C), <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_b</span>(<span class="at">option =</span> <span class="st">"D"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E60E00"</span>, <span class="st">"#55E344"</span>)) <span class="sc">+</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fungicide efficacy (%)"</span>,</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fungicide + Application cost ($)"</span>,</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Pr(I \u2265 C)"</span>,</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># facet_wrap(vars(class, class2)) +</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells  2962435 158.3    4708747  251.5   4708747  251.5
Vcells 85486263 652.3  261029279 1991.5 261024076 1991.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>big <span class="ot">=</span> big_one_df <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">class =</span> <span class="fu">case_when</span>(sn <span class="sc">&gt;</span> <span class="fl">0.25</span> <span class="sc">~</span> <span class="st">"High severity"</span>,</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>                           sn <span class="sc">&lt;=</span> <span class="fl">0.25</span> <span class="sc">~</span><span class="st">"Low severity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>class <span class="ot">&lt;-</span> big <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">105</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&gt;=</span> <span class="fl">0.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lambda <span class="sc">&lt;=</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lambda, C, class) <span class="sc">%&gt;%</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">sumn =</span> <span class="fu">sum</span>(profit), <span class="at">prob =</span> sumn <span class="sc">/</span> n, <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells  2962483 158.3    4708747  251.5   4708747  251.5
Vcells 90167142 688.0  261029279 1991.5 261024076 1991.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>heat_graphic <span class="ot">=</span> class <span class="sc">%&gt;%</span> </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(class)) <span class="sc">%&gt;%</span> </span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="fu">as.factor</span>(lambda <span class="sc">*</span> <span class="dv">100</span>), <span class="fu">as.factor</span>(C), <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label = paste(round(prob, 2), sep = "")),</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># size = 4, colour = "white")+</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_b</span>(<span class="at">option =</span> <span class="st">"E"</span>, <span class="at">direction =</span>  <span class="sc">-</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "E") +</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Treatment efficacy (%)"</span>,</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Treatment cost (USD/ha)"</span>,</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Pr(I \u2265 C)"</span>,</span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(class), <span class="at">ncol =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           used  (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells  2963942 158.3    4708747  251.5   4708747  251.5
Vcells 90170579 688.0  261029279 1991.5 261024076 1991.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>low_class <span class="ot">=</span> class <span class="sc">%&gt;%</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"Low severity"</span>)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(low_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002628466</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(low_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8714784</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(low_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3308383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>low_class <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lambda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["C"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["class"],"name":[3],"type":["chr"],"align":["left"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["sumn"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["prob"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.40","2":"15","3":"Low severity","4":"22820","5":"16468","6":"0.7216477"},{"1":"0.45","2":"15","3":"Low severity","4":"22853","5":"17236","6":"0.7542117"},{"1":"0.50","2":"15","3":"Low severity","4":"23069","5":"18107","6":"0.7849062"},{"1":"0.55","2":"15","3":"Low severity","4":"22708","5":"18344","6":"0.8078210"},{"1":"0.60","2":"15","3":"Low severity","4":"22852","5":"18808","6":"0.8230352"},{"1":"0.65","2":"15","3":"Low severity","4":"22911","5":"19246","6":"0.8400332"},{"1":"0.70","2":"15","3":"Low severity","4":"23115","5":"19736","6":"0.8538179"},{"1":"0.75","2":"15","3":"Low severity","4":"22881","5":"19711","6":"0.8614571"},{"1":"0.80","2":"15","3":"Low severity","4":"22930","5":"19983","6":"0.8714784"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>high_class <span class="ot">=</span> class <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">"High severity"</span>)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(high_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3460665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(high_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(high_class<span class="sc">$</span>prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9033795</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>overall <span class="ot">=</span> big <span class="sc">%&gt;%</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&lt;=</span> <span class="dv">105</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(C <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(sev_class = " Overall") %&gt;% </span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(lambda,class) <span class="sc">%&gt;%</span> </span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">yield_gain_median =</span> <span class="fu">median</span>(yield_gain),</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">yield_gain_mean =</span> <span class="fu">mean</span>(yield_gain),</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">up_95 =</span> <span class="fu">quantile</span>(yield_gain, <span class="fl">0.975</span>),</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">low_95 =</span> <span class="fu">quantile</span>(yield_gain, <span class="fl">0.025</span>),</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">up_75 =</span> <span class="fu">quantile</span>(yield_gain, <span class="fl">0.75</span>),</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">low_75 =</span> <span class="fu">quantile</span>(yield_gain, <span class="fl">0.25</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a> gain_graphic <span class="ot">=</span> overall <span class="sc">%&gt;%</span> </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(lambda<span class="sc">*</span><span class="dv">100</span>,yield_gain_mean))<span class="sc">+</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(lambda<span class="sc">*</span><span class="dv">100</span>, low_95),</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(lambda<span class="sc">*</span><span class="dv">100</span>, up_95),</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="cn">NA</span>,<span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.4</span>, <span class="fu">aes</span>(lambda<span class="sc">*</span><span class="dv">100</span>,yield_gain_median), <span class="at">color =</span> <span class="st">"#ffc425"</span>)<span class="sc">+</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>   <span class="co">#scale_y_continuous(breaks = c(0, 500, 1000, 1500,2000,</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                             2500, 3000), </span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>     <span class="co">#                 limits = c(0, 3000))+</span></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>   <span class="co">#scale_x_continuous(breaks = c(40,50,60,70,80), limits = c(40, 80))+</span></span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_viridis_d()+</span></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = c('steelblue', '#9ccb86', 'darkred'))+</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()<span class="sc">+</span></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">ncol =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~class+class2)+</span></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Treatment efficacy (%)"</span>,</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield difference (kg/ha)"</span>,</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Tolerance level"</span>, </span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>(gain_graphic<span class="sc">+</span>heat_graphic) <span class="sc">+</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>, <span class="at">tag_prefix =</span> <span class="st">"("</span>, <span class="at">tag_suffix =</span> <span class="st">")"</span>)<span class="sc">&amp;</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="about_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"fig/break-even_gain.png"</span>, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>